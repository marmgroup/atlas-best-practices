<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Cleaning movement tracks | Pre-processing high frequency animal tracking data</title>
  <meta name="description" content="TRES Tidyverse Tutorial" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Cleaning movement tracks | Pre-processing high frequency animal tracking data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="TRES Tidyverse Tutorial" />
  <meta name="github-repo" content="pratikunterwegs/atlas-best-practices" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Cleaning movement tracks | Pre-processing high frequency animal tracking data" />
  
  <meta name="twitter:description" content="TRES Tidyverse Tutorial" />
  

<meta name="author" content="Pratik R. Gupte and others" />


<meta name="date" content="2020-08-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cleaning-point-data.html"/>
<link rel="next" href="smoothing-positioning-errors.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Outline</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#installing-atlastools"><i class="fa fa-check"></i><b>0.1</b> Installing <code>atlastools</code></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html"><i class="fa fa-check"></i><b>1</b> Cleaning point data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html#filtering-within-spatio-temporal-bounds"><i class="fa fa-check"></i><b>1.1</b> Filtering within spatio-temporal bounds</a></li>
<li class="chapter" data-level="1.2" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html#filtering-on-covariates"><i class="fa fa-check"></i><b>1.2</b> Filtering on covariates</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html"><i class="fa fa-check"></i><b>2</b> Cleaning movement tracks</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html#filtering-on-speed-and-turning-angle"><i class="fa fa-check"></i><b>2.1</b> Filtering on speed and turning angle</a></li>
<li class="chapter" data-level="2.2" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html#challenges-to-speed-filters"><i class="fa fa-check"></i><b>2.2</b> Challenges to speed filters</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html"><i class="fa fa-check"></i><b>3</b> Smoothing positioning errors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#the-median-smooth"><i class="fa fa-check"></i><b>3.1</b> The median smooth</a></li>
<li class="chapter" data-level="3.2" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#other-smooths"><i class="fa fa-check"></i><b>3.2</b> Other smooths</a></li>
<li class="chapter" data-level="3.3" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#interpolating-data"><i class="fa fa-check"></i><b>3.3</b> Interpolating data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html"><i class="fa fa-check"></i><b>4</b> Reducing data volume</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html#thinning-animal-tracks"><i class="fa fa-check"></i><b>4.1</b> Thinning animal tracks</a></li>
<li class="chapter" data-level="4.2" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html#subsetting-on-behaviourenv-covariates"><i class="fa fa-check"></i><b>4.2</b> Subsetting on behaviour/env covariates</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html"><i class="fa fa-check"></i><b>5</b> Synthesising movement tracks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html#challenges-in-synthesising-high-frequency-trajectories"><i class="fa fa-check"></i><b>5.1</b> Challenges in synthesising high-frequency trajectories</a></li>
<li class="chapter" data-level="5.2" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html#residence-patches-and-their-construction"><i class="fa fa-check"></i><b>5.2</b> Residence patches and their construction</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pre-processing high frequency animal tracking data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-movement-tracks" class="section level1">
<h1><span class="header-section-number">Section 2</span> Cleaning movement tracks</h1>
<div id="filtering-on-speed-and-turning-angle" class="section level2">
<h2><span class="header-section-number">2.1</span> Filtering on speed and turning angle</h2>
<p>Since the phenomenon represented by data from animal tracking studies is movement, it is appropriate and necessary to examine whether individual trajectories obtained by joining positions remaining from previous filtering steps are realistic. This is often a subjective assessment based on expert judgement of the observed movement tracks, which presents two main problems: first, subjective assessments are difficult to reproduce, which hampers consistent analyses across tracking periods. The second issue is that manual identification and correction of problematic trajectories is prohibitively time consuming when dealing with high volumes of data.</p>
<p>The solution to both problems is to employ a hybrid approach, in which experts manually examine a subset of movement tracks (rather than positions) and attempt to identify common problems with the trajectories. Experts can then conceptualise an algorithm by which problematic sections of a trajectory may be removed, and automate the application of this algorithm to the wider dataset, under the assumption that the subset used to define the algorithm was representative of the full data.</p>
<p>Algorithms for filtering trajectories are different from those for filtering point locations in that they commonly filter on derivative variables, i.e., the instantaneous change in some variable with respect to another variable. The two most common derivative variables are speed, the change in position in unit time, and turning angle, the change in heading in unit time. Trajectories must always be checked for correct temporal ordering before calculating metrics with time interval as a denominator. Speed and turning angle filters should be applied in a stepwise fashion, and it is safest to first apply a simple speed filter that removes positions with instantaneous speeds above a certain threshold.</p>
<p>This threshold should be informed by the tracked animal’s biology, but it is also important to consider that high frequency tracking typically overestimates the speed between positions due to positioning error (Ranacher et al. 2016; an explanation for animal tracking data is given in Noonan et al. 2019). Even assuming data with large positioning errors have been removed, it is advisable to begin with a liberal speed threshold that excludes only the most unlikely of movements.</p>
<p>Speed filters have the drawback of removing twice as many positions as strictly necessary (the speed duplication problem). For example, in a trajectory of three positions (p1, p2, and p3), the outlier p2 has a high instantaneous speed, as does the ‘real’ position p3, whose displacement is calculated relative to the outlier p2; both will be removed by the same speed filter. Speed filtering with low thresholds also risks losing valid data on fast transit behaviour of a study species, and this is especially a risk for aerial transit which can be strongly assisted by winds.</p>
<p>In such cases, turning angle filters can help distinguish between high instantaneous speeds arising from positioning error and those that comprise a fast transit segment. Most animals are physiologically constrained to move quickly only in relatively straight lines, i.e., with low turning angles, and large turning angles coupled with high speeds often represent positioning errors in the data, whereas high speed - low angle positions are likely to capture extreme yet real movements.</p>
</div>
<div id="challenges-to-speed-filters" class="section level2">
<h2><span class="header-section-number">2.2</span> Challenges to speed filters</h2>
<p>A more serious challenge to speed filters is the tracking system phenomenon of ‘reflected’ positions, in which the estimated location is instantaneously displaced many hundreds of metres from the individual’s real position for some time, followed by a return to a location near the real position. In such a ‘reflection’ comprised of the positions t1…tr, p1…pn, and tr+1…tn where positions denoted by t represent real trajectory positions, and those denoted p represent reflected data a great distance from the real trajectory, the positions p1 and tr+1 will have very high instantaneous speeds. A speed filter applied to such reflected data would only remove p1 and tr+1, leaving the positions p2…pn, which are erroneous and must be removed. Iteratively applying a speed filter to this data while recalculating speeds in each iteration until no extreme speeds remain is an imperfect solution, since it will remove valid positions tr+i for each erroneous position pi; the true scale of the speed duplication problem is thus revealed. Another approach to identifying reflections and especially to determining where they end is to identify the first position with extreme speeds (p1), and calculating the speed between the preceding position (tr) and all subsequent positions (p1…tn) until the first position with a realistic instantaneous speed relative to tr is located; in this case tr+1. The drawback here is that the method is sensitive to the duration of the reflection, since the speed between tr and subsequent (reflected) positions will decrease exponentially to a realistic value over time (as the denominator time increases), and the algorithm will prematurely consider the reflection to have ended.</p>
<p>A more heuristic approach to dealing with trajectory reflections involves using the phenomenon’s properties to identify its bounds, and removing all positions between these bounds. The first step is identifying anomalous positions with extreme speeds and turning angles, as in the point outlier case. The trajectory can then be split into pre- and post-anomaly segments, and the first position of the post-anomaly segment, which is the inner bound of the reflection, can be set as an anchor point. The first position after the anchor point with an instantaneous speed &gt;= the anchor point can be considered to be the upper bound of the reflection, and lacking such a position, the position with the next greatest instantaneous speed can be considered the outer bound of the reflection. The positions between these bounds can be identified as a trajectory reflection and removed. To prevent the algorithm from searching through many hundreds of thousands of data points, the algorithm can be set to consider a post-anomaly segment of K positions, and to look for the end of the reflection within this bound.</p>
<p>While fast, the drawback with this method is in the simplicity of its assumptions that (1) the first position of the data is correct and not itself a reflection, (2) the reflection ends within K positions, and (3) the individual is not moving towards the reflected positions. Violation of any of these assumptions will cause the method to fail catastrophically: (1) if the first position is a reflection, it will be preserved and real positions will be removed, (2) if the reflection does not end within K positions the algorithm will erroneously assign the highest speed within K positions as the end, and (3) the individual’s real positions overlapping with the reflected positions will result in low speeds between erroneous and real positions, leaving the algorithm unable to find the correct reflection end. If reflections persist in the data after this procedure, or are so prevalent as to cause the algorithm to return erroneous data, there is a limited number of options: (1) attempt to identify whether reflections occur in a common area across individual tracks, and manually identify and remove positions from within the bounds of these so-called ‘attractor points’, (2) subset the data and discard subsets which have more than N anomalous speed-angle positions, as these may indicate many reflected segments, or (3) identify anomalies and remove positions within some time limit of each anomaly, in the hope that the reflection ends by that time.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cleaning-point-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="smoothing-positioning-errors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
