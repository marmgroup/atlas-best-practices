<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Cleaning point data | Pre-processing high frequency animal tracking data</title>
  <meta name="description" content="TRES Tidyverse Tutorial" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Cleaning point data | Pre-processing high frequency animal tracking data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="TRES Tidyverse Tutorial" />
  <meta name="github-repo" content="pratikunterwegs/atlas-best-practices" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Cleaning point data | Pre-processing high frequency animal tracking data" />
  
  <meta name="twitter:description" content="TRES Tidyverse Tutorial" />
  

<meta name="author" content="Pratik R. Gupte and others" />


<meta name="date" content="2020-08-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="background.html"/>
<link rel="next" href="cleaning-movement-tracks.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="background.html"><a href="background.html#install-atlastools"><i class="fa fa-check"></i><b>1.1</b> Install <code>atlastools</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html"><i class="fa fa-check"></i><b>2</b> Cleaning point data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html#filtering-within-spatio-temporal-bounds"><i class="fa fa-check"></i><b>2.1</b> Filtering within spatio-temporal bounds</a></li>
<li class="chapter" data-level="2.2" data-path="cleaning-point-data.html"><a href="cleaning-point-data.html#filtering-on-covariates"><i class="fa fa-check"></i><b>2.2</b> Filtering on covariates</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html"><i class="fa fa-check"></i><b>3</b> Cleaning movement tracks</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html#filtering-on-speed-and-turning-angle"><i class="fa fa-check"></i><b>3.1</b> Filtering on speed and turning angle</a></li>
<li class="chapter" data-level="3.2" data-path="cleaning-movement-tracks.html"><a href="cleaning-movement-tracks.html#challenges-to-speed-filters"><i class="fa fa-check"></i><b>3.2</b> Challenges to speed filters</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html"><i class="fa fa-check"></i><b>4</b> Smoothing positioning errors</a>
<ul>
<li class="chapter" data-level="4.1" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#the-median-smooth"><i class="fa fa-check"></i><b>4.1</b> The median smooth</a></li>
<li class="chapter" data-level="4.2" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#other-smooths"><i class="fa fa-check"></i><b>4.2</b> Other smooths</a></li>
<li class="chapter" data-level="4.3" data-path="smoothing-positioning-errors.html"><a href="smoothing-positioning-errors.html#interpolating-data"><i class="fa fa-check"></i><b>4.3</b> Interpolating data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html"><i class="fa fa-check"></i><b>5</b> Reducing data volume</a>
<ul>
<li class="chapter" data-level="5.1" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html#thinning-animal-tracks"><i class="fa fa-check"></i><b>5.1</b> Thinning animal tracks</a></li>
<li class="chapter" data-level="5.2" data-path="reducing-data-volume.html"><a href="reducing-data-volume.html#subsetting-on-behaviourenv-covariates"><i class="fa fa-check"></i><b>5.2</b> Subsetting on behaviour/env covariates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html"><i class="fa fa-check"></i><b>6</b> Synthesising movement tracks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html#challenges-in-synthesising-high-frequency-trajectories"><i class="fa fa-check"></i><b>6.1</b> Challenges in synthesising high-frequency trajectories</a></li>
<li class="chapter" data-level="6.2" data-path="synthesising-movement-tracks.html"><a href="synthesising-movement-tracks.html#residence-patches-and-their-construction"><i class="fa fa-check"></i><b>6.2</b> Residence patches and their construction</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pre-processing high frequency animal tracking data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-point-data" class="section level1">
<h1><span class="header-section-number">Section 2</span> Cleaning point data</h1>
<div id="filtering-within-spatio-temporal-bounds" class="section level2">
<h2><span class="header-section-number">2.1</span> Filtering within spatio-temporal bounds</h2>
<p>Here, we simulate some movement data using the <code>smoove</code> <code>R</code> package from <span class="citation">[@gurarie2017]</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="cleaning-point-data.html#cb2-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb2-2"><a href="cleaning-point-data.html#cb2-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="cleaning-point-data.html#cb2-3"></a></span>
<span id="cb2-4"><a href="cleaning-point-data.html#cb2-4"></a><span class="kw">library</span>(atlastools)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="cleaning-point-data.html#cb3-1"></a><span class="co"># uses smoove from Gurarie et al. (2017)</span></span>
<span id="cb3-2"><a href="cleaning-point-data.html#cb3-2"></a><span class="kw">library</span>(smoove)</span>
<span id="cb3-3"><a href="cleaning-point-data.html#cb3-3"></a>nu &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb3-4"><a href="cleaning-point-data.html#cb3-4"></a>tau &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb3-5"><a href="cleaning-point-data.html#cb3-5"></a>dt &lt;-<span class="st"> </span><span class="fl">.1</span> </span>
<span id="cb3-6"><a href="cleaning-point-data.html#cb3-6"></a>ucvm1 &lt;-<span class="st"> </span><span class="kw">simulateUCVM</span>(<span class="dt">nu=</span>nu, <span class="dt">tau=</span>tau, <span class="dt">T.max =</span> <span class="dv">100</span>, <span class="dt">dt =</span> dt)</span>
<span id="cb3-7"><a href="cleaning-point-data.html#cb3-7"></a></span>
<span id="cb3-8"><a href="cleaning-point-data.html#cb3-8"></a><span class="co"># add a reflection to x_max + x_max / 10, y_max + y_max / 10</span></span>
<span id="cb3-9"><a href="cleaning-point-data.html#cb3-9"></a>data &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(ucvm1<span class="op">$</span>XY)</span>
<span id="cb3-10"><a href="cleaning-point-data.html#cb3-10"></a>data[, time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">seq_len</span>(<span class="kw">nrow</span>(data))]</span>
<span id="cb3-11"><a href="cleaning-point-data.html#cb3-11"></a>data &lt;-<span class="st"> </span>data[<span class="kw">seq_len</span>(<span class="dv">1000</span>), ]</span>
<span id="cb3-12"><a href="cleaning-point-data.html#cb3-12"></a></span>
<span id="cb3-13"><a href="cleaning-point-data.html#cb3-13"></a><span class="kw">fwrite</span>(data, <span class="st">&quot;data/sim_data_sec_02_01.csv&quot;</span>)</span></code></pre></div>
<p>Here we read the simulated data in, and plot it to observe its extent.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="cleaning-point-data.html#cb4-1"></a><span class="co"># read in the data</span></span>
<span id="cb4-2"><a href="cleaning-point-data.html#cb4-2"></a>data &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">fread</span>(<span class="st">&quot;data/sim_data_sec_02_01.csv&quot;</span>)</span>
<span id="cb4-3"><a href="cleaning-point-data.html#cb4-3"></a></span>
<span id="cb4-4"><a href="cleaning-point-data.html#cb4-4"></a><span class="co"># process the data to remove points in this range</span></span>
<span id="cb4-5"><a href="cleaning-point-data.html#cb4-5"></a>data_excluded &lt;-<span class="st"> </span>atlastools<span class="op">::</span><span class="kw">atl_filter_bounds</span>(data,</span>
<span id="cb4-6"><a href="cleaning-point-data.html#cb4-6"></a>                                               <span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-7"><a href="cleaning-point-data.html#cb4-7"></a>                                               <span class="dt">x_range =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">0</span>),</span>
<span id="cb4-8"><a href="cleaning-point-data.html#cb4-8"></a>                                               <span class="dt">y_range =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">35</span>, <span class="dv">-15</span>))</span>
<span id="cb4-9"><a href="cleaning-point-data.html#cb4-9"></a><span class="co"># process to keep points inside</span></span>
<span id="cb4-10"><a href="cleaning-point-data.html#cb4-10"></a>data_included &lt;-<span class="st"> </span>atlastools<span class="op">::</span><span class="kw">atl_filter_bounds</span>(data,</span>
<span id="cb4-11"><a href="cleaning-point-data.html#cb4-11"></a>                                               <span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb4-12"><a href="cleaning-point-data.html#cb4-12"></a>                                               <span class="dt">x_range =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">15</span>, <span class="dv">0</span>),</span>
<span id="cb4-13"><a href="cleaning-point-data.html#cb4-13"></a>                                               <span class="dt">y_range =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">35</span>, <span class="dv">-15</span>),</span>
<span id="cb4-14"><a href="cleaning-point-data.html#cb4-14"></a>                                               <span class="dt">remove_inside =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-15"><a href="cleaning-point-data.html#cb4-15"></a></span>
<span id="cb4-16"><a href="cleaning-point-data.html#cb4-16"></a><span class="co"># join the data</span></span>
<span id="cb4-17"><a href="cleaning-point-data.html#cb4-17"></a>data[, type <span class="op">:</span><span class="er">=</span><span class="st"> &quot;raw&quot;</span>]</span>
<span id="cb4-18"><a href="cleaning-point-data.html#cb4-18"></a>data_excluded[, type <span class="op">:</span><span class="er">=</span><span class="st"> &quot;bbox excluded&quot;</span>]</span>
<span id="cb4-19"><a href="cleaning-point-data.html#cb4-19"></a>data_included[, type <span class="op">:</span><span class="er">=</span><span class="st"> &quot;bbox included&quot;</span>]</span>
<span id="cb4-20"><a href="cleaning-point-data.html#cb4-20"></a>data &lt;-<span class="st"> </span><span class="kw">rbind</span>(data, data_excluded, data_included)</span>
<span id="cb4-21"><a href="cleaning-point-data.html#cb4-21"></a></span>
<span id="cb4-22"><a href="cleaning-point-data.html#cb4-22"></a><span class="co"># arrange type</span></span>
<span id="cb4-23"><a href="cleaning-point-data.html#cb4-23"></a>data<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>type, </span>
<span id="cb4-24"><a href="cleaning-point-data.html#cb4-24"></a>                    <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;bbox excluded&quot;</span>, <span class="st">&quot;bbox included&quot;</span>))</span></code></pre></div>
<div class="figure">
<img src="figures/fig_filter_bbox.png" alt="" />
<p class="caption">Filtering by bounding box.</p>
</div>
<p>Explicit spatial filtering is a finer method which examines whether the tracking data lie within a polygon, which may be irregular. This typically involves converting the data’s position coordinates to a multi-point spatial geometry, and finding the intersection with a polygon or multi-polygon geometry representing a study area.
Combined with knowledge of species’ biology and the study site, explicit spatial filtering can be used to remove obviously erroneous positions such as those that would place an individual in an area it is physiologically incapable of traversing. The main drawback to explicit spatial filtering is that it is computationally intensive, and it is advisable to apply a coarse bounding box filter first in order to reduce the computational load, and only then filter by an irregular spatial feature.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="cleaning-point-data.html#cb5-1"></a><span class="co"># make circular buffer around centroid</span></span></code></pre></div>
<p>Both bounding box and explicit spatial filters can be combined with the timestamp of a position to remove locations where time is an important determinant of accessibility. For example, terrestrial species may be able to access the bottom of a waterbody only during certain times of day or year, and data whose time and position coordinates do not meet these criteria can be removed.
Temporal filtering can also be applied independently of spatial filtering to exclude positions from certain time periods during tracking. These are typically periods when data are expected to be biased, such as where an animal has been fitted with a tracker but has not been released, or from the first day after fitting a tracker to avoid including movement behaviour biased by the stress of the capture.
When combining spatial and temporal filters, it is better to apply the temporal filter first, since it is less computationally intensive than even a bounding box filter, and much less so than an explicit spatial filter, while reducing the number of positions that must be examined by these subsequent filters.
In any case, broad filters must always be applied with caution; they are especially susceptible to excluding data that represent novel behaviour of which researchers are unaware, such as a new movement mode or changed local conditions which make it possible for species to move across previously inaccessible regions.</p>

</div>
<div id="filtering-on-covariates" class="section level2">
<h2><span class="header-section-number">2.2</span> Filtering on covariates</h2>
<p>Simple spatial and temporal filters are agnostic to any correlation between the status of a tracking system and the extent of error. However, both may be refined by consulting tracking system metadata, i.e., data on the status of the tracking system itself, which can be a good indicator of the reliability of calculated positions. For example, at a broad scale the number of active receivers in an ATLAS system can indicate time periods when a system suffers a malfunction and thus collects unreliable data; these ‘down times’ can form the basis of a temporal filter. Similarly, data from system tests may reveal regions of the study area in which the system’s localisations are error-prone, and can inform an explicit spatial filter. At smaller scales the observation-specific metadata may be used to filter out locations which fail to meet a certain cutoff. For example, ATLAS systems calculate animal positions using the times of arrival of a radio transmission from each tag to multiple receiver stations. The number of receiver stations involved in each localisation is considered to be an indicator of data quality, and positions localised using fewer than three receivers (the minimum required for an ATLAS localisation) can be excluded.</p>
<p>Further, tracking systems often yield internal measures of positioning error which are based on the dilution of precision. ATLAS and other time-of-arrival systems calculate positioning error in two dimensions (MacCurdy et al. 2009), while other systems may yield a three dimensional positioning error. Positioning error is an intuitive criterion by which to filter data, and this takes the form of locations with an estimated error above a certain threshold being excluded. There are two other ways of dealing with positioning errors, and of these the aggregation of positions over a time interval is discussed below. The more demanding method is to model the animal’s movement, for example, in a continuous time movement model (Calabrese et al. 2016; Noonan et al. 2019). Movement model methods can use the positioning error from the tracking system, in conjunction with calibration data, to estimate the real individual position and movement distances between positions. However, movement model methods are computationally intensive, make several assumptions about animal movement, and can be challenging to implement for the beginning practitioner, and are not discussed further.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="background.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cleaning-movement-tracks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
