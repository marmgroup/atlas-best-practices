<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Reducing Small-Scale Positioning Error and Aggregating Data | A Rough Guide to Pre-processing High-Frequency Animal Tracking Data</title>
  <meta name="description" content="Source code for a guide to pre-processing high-frequency tracking data." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Reducing Small-Scale Positioning Error and Aggregating Data | A Rough Guide to Pre-processing High-Frequency Animal Tracking Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Source code for a guide to pre-processing high-frequency tracking data." />
  <meta name="github-repo" content="pratikunterwegs/atlas-best-practices" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Reducing Small-Scale Positioning Error and Aggregating Data | A Rough Guide to Pre-processing High-Frequency Animal Tracking Data" />
  
  <meta name="twitter:description" content="Source code for a guide to pre-processing high-frequency tracking data." />
  

<meta name="author" content="Pratik R. Gupte and others" />


<meta name="date" content="2020-10-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reducing-large-scale-positioning-error-by-filtering-data.html"/>
<link rel="next" href="residence-patches-and-their-construction.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#installing-atlastools"><i class="fa fa-check"></i><b>2.1</b> Installing <code>atlastools</code></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#simulating-movement-data"><i class="fa fa-check"></i><b>2.2</b> Simulating movement data</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#simualte-for-residence-patches"><i class="fa fa-check"></i><b>2.3</b> Simualte for residence patches</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html"><i class="fa fa-check"></i><b>3</b> Reducing Large-Scale Positioning Error by Filtering Data</a><ul>
<li class="chapter" data-level="3.1" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#prepare-libraries"><i class="fa fa-check"></i><b>3.1</b> Prepare Libraries</a></li>
<li class="chapter" data-level="3.2" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#introducing-errors-to-the-data"><i class="fa fa-check"></i><b>3.2</b> Introducing Errors to the Data</a></li>
<li class="chapter" data-level="3.3" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#filtering-by-spatial-bounds"><i class="fa fa-check"></i><b>3.3</b> Filtering by Spatial Bounds</a><ul>
<li class="chapter" data-level="3.3.1" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#a-note-on-filtering-by-bounds"><i class="fa fa-check"></i><b>3.3.1</b> A Note on Filtering by Bounds</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#filtering-unrealistic-movement"><i class="fa fa-check"></i><b>3.4</b> Filtering Unrealistic Movement</a><ul>
<li class="chapter" data-level="3.4.1" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#filtering-point-outliers-or-spikes"><i class="fa fa-check"></i><b>3.4.1</b> Filtering Point Outliers or Spikes</a></li>
<li class="chapter" data-level="3.4.2" data-path="reducing-large-scale-positioning-error-by-filtering-data.html"><a href="reducing-large-scale-positioning-error-by-filtering-data.html#filtering-reflections-or-track-subsets"><i class="fa fa-check"></i><b>3.4.2</b> Filtering Reflections or Track Subsets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html"><i class="fa fa-check"></i><b>4</b> Reducing Small-Scale Positioning Error and Aggregating Data</a><ul>
<li class="chapter" data-level="4.1" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html#preparing-libraries-and-data"><i class="fa fa-check"></i><b>4.1</b> Preparing Libraries and Data</a></li>
<li class="chapter" data-level="4.2" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html#median-smoothing"><i class="fa fa-check"></i><b>4.2</b> Median Smoothing</a></li>
<li class="chapter" data-level="4.3" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html#thinning-data-by-aggregation"><i class="fa fa-check"></i><b>4.3</b> Thinning Data by Aggregation</a></li>
<li class="chapter" data-level="4.4" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html#aggregation-before-reducing-positioning-errors"><i class="fa fa-check"></i><b>4.4</b> Aggregation Before Reducing Positioning Errors</a><ul>
<li class="chapter" data-level="4.4.1" data-path="reducing-small-scale-positioning-error-and-aggregating-data.html"><a href="reducing-small-scale-positioning-error-and-aggregating-data.html#comparing-median-aggregation-with-and-without-smoothing"><i class="fa fa-check"></i><b>4.4.1</b> Comparing median aggregation with and without smoothing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="residence-patches-and-their-construction.html"><a href="residence-patches-and-their-construction.html"><i class="fa fa-check"></i><b>5</b> Residence patches and their construction</a><ul>
<li class="chapter" data-level="" data-path="residence-patches-and-their-construction.html"><a href="residence-patches-and-their-construction.html#prepare-libraries-1"><i class="fa fa-check"></i>Prepare libraries</a></li>
<li class="chapter" data-level="5.1" data-path="residence-patches-and-their-construction.html"><a href="residence-patches-and-their-construction.html#an-example-with-simulated-data"><i class="fa fa-check"></i><b>5.1</b> An example with simulated data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="residence-patches-and-their-construction.html"><a href="residence-patches-and-their-construction.html#read-data-and-classify"><i class="fa fa-check"></i><b>5.1.1</b> Read data and classify</a></li>
<li class="chapter" data-level="5.1.2" data-path="residence-patches-and-their-construction.html"><a href="residence-patches-and-their-construction.html#plot-classified-residence-patches"><i class="fa fa-check"></i><b>5.1.2</b> Plot classified residence patches</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html"><i class="fa fa-check"></i><b>6</b> Processing calibration data</a><ul>
<li class="chapter" data-level="6.1" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#prepare-libraries-2"><i class="fa fa-check"></i><b>6.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="6.2" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#preliminary-visualisation"><i class="fa fa-check"></i><b>6.2</b> Preliminary visualisation</a></li>
<li class="chapter" data-level="6.3" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#filter-by-bounding-box"><i class="fa fa-check"></i><b>6.3</b> Filter by bounding box</a></li>
<li class="chapter" data-level="6.4" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#filter-trajectories"><i class="fa fa-check"></i><b>6.4</b> Filter trajectories</a><ul>
<li class="chapter" data-level="6.4.1" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#handle-time"><i class="fa fa-check"></i><b>6.4.1</b> Handle time</a></li>
<li class="chapter" data-level="6.4.2" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#add-speed-and-turning-angle"><i class="fa fa-check"></i><b>6.4.2</b> Add speed and turning angle</a></li>
<li class="chapter" data-level="6.4.3" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#get-95th-percentile-of-speed-and-angle"><i class="fa fa-check"></i><b>6.4.3</b> Get 95th percentile of speed and angle</a></li>
<li class="chapter" data-level="6.4.4" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#plot-to-see-speeds"><i class="fa fa-check"></i><b>6.4.4</b> Plot to see speeds</a></li>
<li class="chapter" data-level="6.4.5" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#filter-on-speed"><i class="fa fa-check"></i><b>6.4.5</b> Filter on speed</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#smoothing-the-trajectory"><i class="fa fa-check"></i><b>6.5</b> Smoothing the trajectory</a><ul>
<li class="chapter" data-level="6.5.1" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#plot-pre-processing-steps"><i class="fa fa-check"></i><b>6.5.1</b> Plot pre-processing steps</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#making-residence-patches"><i class="fa fa-check"></i><b>6.6</b> Making residence patches</a><ul>
<li class="chapter" data-level="6.6.1" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#prepare-data"><i class="fa fa-check"></i><b>6.6.1</b> Prepare data</a></li>
<li class="chapter" data-level="6.6.2" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#calculate-residence-time"><i class="fa fa-check"></i><b>6.6.2</b> Calculate residence time</a></li>
<li class="chapter" data-level="6.6.3" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#plot-residence-time"><i class="fa fa-check"></i><b>6.6.3</b> Plot residence time</a></li>
<li class="chapter" data-level="6.6.4" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#run-residence-patch-method"><i class="fa fa-check"></i><b>6.6.4</b> Run residence patch method</a></li>
<li class="chapter" data-level="6.6.5" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#get-spatial-and-summary-objects"><i class="fa fa-check"></i><b>6.6.5</b> Get spatial and summary objects</a></li>
<li class="chapter" data-level="6.6.6" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#get-waypoint-centroids"><i class="fa fa-check"></i><b>6.6.6</b> Get waypoint centroids</a></li>
<li class="chapter" data-level="6.6.7" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#read-griend"><i class="fa fa-check"></i><b>6.6.7</b> Read Griend</a></li>
<li class="chapter" data-level="6.6.8" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#plot-the-outcome"><i class="fa fa-check"></i><b>6.6.8</b> Plot the outcome</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#compare-patch-metrics"><i class="fa fa-check"></i><b>6.7</b> Compare patch metrics</a><ul>
<li class="chapter" data-level="6.7.1" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#compare-known-patches"><i class="fa fa-check"></i><b>6.7.1</b> Compare known patches</a></li>
<li class="chapter" data-level="6.7.2" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#plot-durations-comparisons"><i class="fa fa-check"></i><b>6.7.2</b> Plot durations comparisons</a></li>
<li class="chapter" data-level="6.7.3" data-path="processing-calibration-data.html"><a href="processing-calibration-data.html#join-patch-map-and-duration-comparison-figure"><i class="fa fa-check"></i><b>6.7.3</b> Join patch map and duration comparison figure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Rough Guide to Pre-processing High-Frequency Animal Tracking Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reducing-small-scale-positioning-error-and-aggregating-data" class="section level1">
<h1><span class="header-section-number">Section 4</span> Reducing Small-Scale Positioning Error and Aggregating Data</h1>
<p>Once large-scale positioning errors have been removed using filters on bounds or on unrealistic movement, small-scale positioning errors may remain. Why is this the case?</p>
<p>The simple reason is that high-frequency tracking has a large component of error relative to the real movement of an individual, and the error / movement ratio increases with the frequency of tracking. <span class="citation">(Noonan et al. <a href="#ref-noonan2019">2019</a>)</span> has a better explanation, which users are strongly recommended to read.</p>
<p>The effect of these small-scale errors for high-frequency data is to cause overestimations of straight-line displacement (distance between two positions) and speed. If users were to apply a very strict speed filter, many of these positions would be lost. This loss of information would certainly reduce the sampling frequency, which would lead to better estimates of total distance and mean speed. However, while <em>total</em> distance and <em>mean</em> speed estimates would improve, the instantaneous distance and speed estimates would remain biased, which will most likely lead to erroneous inferences from the data.</p>
<p>However, users can turn the high-frequency of their data against itself by applying a simple smooth. The median smooth is recommended because it is robust to outliers, and is very well understood.</p>
<div id="preparing-libraries-and-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Preparing Libraries and Data</h2>
<p>We first load some useful packages and define a colour palette.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># prep libs</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">library</span>(atlastools)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb21-6" title="6"></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co"># prepare a palette</span></a>
<a class="sourceLine" id="cb21-8" title="8">pal &lt;-<span class="st"> </span>RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;PRGn&quot;</span>)</a></code></pre></div>
<p>We load both the simulated, canonical data (which has no errors), as well as the data with errors which has been pre-processed to remove large-scale errors.</p>
<p>We also assign a variable, <code>window_size</code>, which will help identify the datasets when comparing median smooth moving window (<span class="math inline">\(K\)</span>) sizes.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># read in the data and set the window size variable</span></a>
<a class="sourceLine" id="cb22-2" title="2">data &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;data/data_sim.csv&quot;</span>)[<span class="dv">5000</span><span class="op">:</span><span class="dv">10000</span>, ]</a>
<a class="sourceLine" id="cb22-3" title="3">data[, window_size <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="ot">NA</span>]</a>
<a class="sourceLine" id="cb22-4" title="4"></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co"># data with small scale errors but no reflections or outliers</span></a>
<a class="sourceLine" id="cb22-6" title="6">data_errors &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;data/data_no_reflection.csv&quot;</span>)</a>
<a class="sourceLine" id="cb22-7" title="7">data_errors[, window_size <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">0</span>]</a></code></pre></div>
</div>
<div id="median-smoothing" class="section level2">
<h2><span class="header-section-number">4.2</span> Median Smoothing</h2>
<p>We apply a median smooth with four different values of <span class="math inline">\(K\)</span>, the moving window size — 3, 5, 11, and 21 positions.
<span class="math inline">\(K\)</span> must be an odd number, but apart from that there is no correct magnitude of <span class="math inline">\(K\)</span>.
Very large <span class="math inline">\(K\)</span> will lead to unrealistic tracks, while small <span class="math inline">\(K\)</span> will not result in much reduction of error.
Users are encouraged to plot their data before and after smoothing to examine the effect of different window sizes.</p>
<p>The <code>atlastools</code> function <code>atl_median_smooth</code> is quite fast and users can readily try multiple <span class="math inline">\(K\)</span> values as shown in the example below.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># smooth the data over four K values</span></a>
<a class="sourceLine" id="cb23-2" title="2">list_of_smooths &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">21</span>), <span class="cf">function</span>(K) {</a>
<a class="sourceLine" id="cb23-3" title="3">  </a>
<a class="sourceLine" id="cb23-4" title="4">  data_copy &lt;-<span class="st"> </span><span class="kw">copy</span>(data_errors)</a>
<a class="sourceLine" id="cb23-5" title="5">  </a>
<a class="sourceLine" id="cb23-6" title="6">  data_copy &lt;-<span class="st"> </span><span class="kw">atl_median_smooth</span>(<span class="dt">data =</span> data_copy,</a>
<a class="sourceLine" id="cb23-7" title="7">                    <span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, </a>
<a class="sourceLine" id="cb23-8" title="8">                    <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>,</a>
<a class="sourceLine" id="cb23-9" title="9">                    <span class="dt">time =</span> <span class="st">&quot;time&quot;</span>,</a>
<a class="sourceLine" id="cb23-10" title="10">                    <span class="dt">moving_window =</span> K)</a>
<a class="sourceLine" id="cb23-11" title="11">  </a>
<a class="sourceLine" id="cb23-12" title="12">  data_copy[, window_size <span class="op">:</span><span class="er">=</span><span class="st"> </span>K]</a>
<a class="sourceLine" id="cb23-13" title="13">})</a></code></pre></div>
<p>We save the 11 point smoothed data.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">fwrite</span>(list_of_smooths[[<span class="dv">3</span>]], <span class="dt">file =</span> <span class="st">&quot;data/data_smooth.csv&quot;</span>)</a></code></pre></div>
<p>We prepare the data for plotting.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># bind list after offset</span></a>
<a class="sourceLine" id="cb25-2" title="2">data_plot &lt;-<span class="st"> </span><span class="kw">mapply</span>(<span class="cf">function</span>(df, offset) {</a>
<a class="sourceLine" id="cb25-3" title="3">  df[, x <span class="op">:</span><span class="er">=</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>offset]</a>
<a class="sourceLine" id="cb25-4" title="4">}, list_of_smooths, <span class="kw">seq</span>(<span class="fl">0.4</span>, <span class="fl">1.25</span>, <span class="dt">length.out =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb25-5" title="5"><span class="dt">SIMPLIFY =</span> F)</a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7">data_plot &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(data_plot)</a></code></pre></div>
<p>We prepare a plot of the smoothed data.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># prepare data to plot</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co"># make list of data to plot</span></a>
<a class="sourceLine" id="cb26-3" title="3">figure_median_smooth &lt;-</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> data_errors,</a>
<a class="sourceLine" id="cb26-6" title="6">             <span class="kw">aes</span>(x, y),</a>
<a class="sourceLine" id="cb26-7" title="7">             <span class="dt">col =</span> pal[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb26-8" title="8">             <span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> data,</a>
<a class="sourceLine" id="cb26-10" title="10">            <span class="kw">aes</span>(x, y),</a>
<a class="sourceLine" id="cb26-11" title="11">            <span class="dt">col =</span> <span class="st">&quot;grey20&quot;</span>,</a>
<a class="sourceLine" id="cb26-12" title="12">            <span class="dt">lwd =</span> <span class="fl">0.5</span>)<span class="op">+</span><span class="st">          </span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> data_plot,</a>
<a class="sourceLine" id="cb26-14" title="14">            <span class="kw">aes</span>(x, y,</a>
<a class="sourceLine" id="cb26-15" title="15">                <span class="dt">col =</span> window_size,</a>
<a class="sourceLine" id="cb26-16" title="16">                <span class="dt">group =</span> window_size),</a>
<a class="sourceLine" id="cb26-17" title="17">            <span class="dt">show.legend =</span> F,</a>
<a class="sourceLine" id="cb26-18" title="18">            <span class="dt">lwd =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="st">  </span><span class="kw">coord_equal</span>(<span class="dt">expand =</span> F,</a>
<a class="sourceLine" id="cb26-20" title="20">              <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.85</span>),</a>
<a class="sourceLine" id="cb26-21" title="21">              <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="fl">2.3</span>),</a>
<a class="sourceLine" id="cb26-22" title="22">              <span class="dt">ratio =</span> <span class="fl">1.75</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb26-24" title="24">           <span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="kw">seq</span>(<span class="fl">1.1</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> <span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb26-25" title="25">           <span class="dt">y =</span> <span class="fl">0.82</span>,</a>
<a class="sourceLine" id="cb26-26" title="26">           <span class="dt">label =</span> <span class="kw">sprintf</span>(<span class="st">&quot;(%s)&quot;</span>, letters[<span class="kw">seq</span>(<span class="dv">5</span>)]),</a>
<a class="sourceLine" id="cb26-27" title="27">           <span class="dt">fontface =</span> <span class="st">&quot;bold&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-28" title="28"><span class="st">  </span><span class="kw">scale_colour_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;BuPu&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb26-29" title="29">                         <span class="dt">values =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">1</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb26-30" title="30"><span class="st">  </span>ggthemes<span class="op">::</span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb26-31" title="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-32" title="32">        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb26-33" title="33">        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey99&quot;</span>))</a>
<a class="sourceLine" id="cb26-34" title="34"></a>
<a class="sourceLine" id="cb26-35" title="35"><span class="co"># save figure</span></a>
<a class="sourceLine" id="cb26-36" title="36"><span class="kw">ggsave</span>(figure_median_smooth, <span class="dt">filename =</span> <span class="st">&quot;figures/fig_median_smooth.png&quot;</span>,</a>
<a class="sourceLine" id="cb26-37" title="37">       <span class="dt">width =</span> <span class="dv">170</span>, <span class="dt">height =</span> <span class="dv">170</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>, <span class="dt">units =</span> <span class="st">&quot;mm&quot;</span>)</a></code></pre></div>
</div>
<div id="thinning-data-by-aggregation" class="section level2">
<h2><span class="header-section-number">4.3</span> Thinning Data by Aggregation</h2>
<p>Evenly thinning data is a good idea if statistical methods require even sampling, or if the volume of data is too large for statistical packages to efficiently handle it. In <code>R</code>, both may be true at once.</p>
<p>Here, we demonstrate thinning by aggregation on data that has been median smoothed using a <span class="math inline">\(K\)</span> of 11.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># choose the 11 point median smooth data</span></a>
<a class="sourceLine" id="cb27-2" title="2">data_agg &lt;-<span class="st"> </span><span class="kw">copy</span>(list_of_smooths[[<span class="dv">3</span>]])</a>
<a class="sourceLine" id="cb27-3" title="3"></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co"># get list of aggregated data</span></a>
<a class="sourceLine" id="cb27-5" title="5">list_of_agg &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">120</span>), <span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb27-6" title="6">  </a>
<a class="sourceLine" id="cb27-7" title="7">  data_return &lt;-<span class="st"> </span><span class="kw">atl_thin_data</span>(<span class="dt">data =</span> data_agg,</a>
<a class="sourceLine" id="cb27-8" title="8">                            <span class="dt">interval =</span> z,</a>
<a class="sourceLine" id="cb27-9" title="9">                            <span class="dt">method =</span> <span class="st">&quot;aggregate&quot;</span>)</a>
<a class="sourceLine" id="cb27-10" title="10">  </a>
<a class="sourceLine" id="cb27-11" title="11">  data_return[, interval <span class="op">:</span><span class="er">=</span><span class="st"> </span>z]</a>
<a class="sourceLine" id="cb27-12" title="12">  </a>
<a class="sourceLine" id="cb27-13" title="13">  <span class="kw">return</span>(data_return)</a>
<a class="sourceLine" id="cb27-14" title="14">})</a>
<a class="sourceLine" id="cb27-15" title="15"></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="co"># get mean speed estimate and sd</span></a>
<a class="sourceLine" id="cb27-17" title="17">speed_agg_smooth &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb27-18" title="18"><span class="st">  </span><span class="kw">lapply</span>(list_of_agg, <span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb27-19" title="19">    <span class="kw">na.omit</span>(df)</a>
<a class="sourceLine" id="cb27-20" title="20">    df[, speed <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">atl_get_speed</span>(df)]</a>
<a class="sourceLine" id="cb27-21" title="21">    df[, <span class="kw">list</span>(<span class="dt">median =</span> <span class="kw">median</span>(speed, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb27-22" title="22">              <span class="dt">sd =</span> <span class="kw">sd</span>(speed, <span class="dt">na.rm =</span> T),</a>
<a class="sourceLine" id="cb27-23" title="23">              <span class="dt">interval =</span> <span class="kw">first</span>(interval))]</a>
<a class="sourceLine" id="cb27-24" title="24">  })</a>
<a class="sourceLine" id="cb27-25" title="25"></a>
<a class="sourceLine" id="cb27-26" title="26"><span class="co"># bind</span></a>
<a class="sourceLine" id="cb27-27" title="27">speed_agg_smooth &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(speed_agg_smooth)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">### plot figures</span></a>
<a class="sourceLine" id="cb28-2" title="2">fig_agg_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">lapply</span>(list_of_agg, <span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb28-4" title="4">    <span class="kw">ggplot</span>(df)<span class="op">+</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">data =</span> data_agg,</a>
<a class="sourceLine" id="cb28-6" title="6">                 <span class="kw">aes</span>(x, y),</a>
<a class="sourceLine" id="cb28-7" title="7">                 <span class="dt">size =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb28-8" title="8">                 <span class="dt">col =</span> pal[<span class="dv">3</span>])<span class="op">+</span></a>
<a class="sourceLine" id="cb28-9" title="9"><span class="st">      </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(x,y), </a>
<a class="sourceLine" id="cb28-10" title="10">                <span class="dt">col =</span> pal[<span class="dv">1</span>])<span class="op">+</span></a>
<a class="sourceLine" id="cb28-11" title="11"><span class="st">      </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(x,y, </a>
<a class="sourceLine" id="cb28-12" title="12">                     <span class="dt">size =</span> SD,</a>
<a class="sourceLine" id="cb28-13" title="13">                     <span class="dt">fill =</span> SD,</a>
<a class="sourceLine" id="cb28-14" title="14">                     <span class="dt">group =</span> interval),</a>
<a class="sourceLine" id="cb28-15" title="15">                 <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb28-16" title="16">                 <span class="dt">alpha =</span> <span class="fl">0.8</span>,</a>
<a class="sourceLine" id="cb28-17" title="17">                 <span class="dt">show.legend =</span> F)<span class="op">+</span></a>
<a class="sourceLine" id="cb28-18" title="18"><span class="st">      </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;Purples&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb28-19" title="19">                           <span class="dt">values =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.25</span>, <span class="dv">1</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-20" title="20"><span class="st">      </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-21" title="21"><span class="st">      </span>ggthemes<span class="op">::</span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb28-22" title="22"><span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb28-23" title="23">            <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb28-24" title="24">            <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey99&quot;</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="st">      </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb28-26" title="26">  })</a></code></pre></div>
</div>
<div id="aggregation-before-reducing-positioning-errors" class="section level2">
<h2><span class="header-section-number">4.4</span> Aggregation Before Reducing Positioning Errors</h2>
<p>Users may rightly wonder whether they can get away with aggregating their data, using a median aggregation function, and reduce data volumes, correct uneven sampling frequency, and reduce large-scale errors all in one go.</p>
<p>The answer to most questions in ecology is, “It depends”. Median aggregation before correcting positioning errors can indeed be advantageous; for instance for faster visualisation while preserving the broad structure of a track.</p>
<p>However, there are drawbacks. The main one is that information is lost in the aggregation process, lending less power to steps such as smoothing applied after aggregation.
Further, aggregation (and indeed any kind of thinning) results in significantly different estimates of speed and distance from the real speed.</p>
<p>We show the effect of aggregating before any error correction here.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># read data with errors</span></a>
<a class="sourceLine" id="cb29-2" title="2">data_errors &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;data/data_errors.csv&quot;</span>)</a>
<a class="sourceLine" id="cb29-3" title="3">  </a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># aggregate before correction</span></a>
<a class="sourceLine" id="cb29-5" title="5">list_of_agg &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">120</span>), <span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb29-6" title="6">  data_return &lt;-<span class="st"> </span><span class="kw">atl_thin_data</span>(<span class="dt">data =</span> data_errors,</a>
<a class="sourceLine" id="cb29-7" title="7">                            <span class="dt">interval =</span> z,</a>
<a class="sourceLine" id="cb29-8" title="8">                            <span class="dt">method =</span> <span class="st">&quot;aggregate&quot;</span>)</a>
<a class="sourceLine" id="cb29-9" title="9">  data_return[, interval <span class="op">:</span><span class="er">=</span><span class="st"> </span>z]</a>
<a class="sourceLine" id="cb29-10" title="10">  data_return[, speed <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">atl_get_speed</span>(data_return)]</a>
<a class="sourceLine" id="cb29-11" title="11">  <span class="kw">return</span>(data_return)</a>
<a class="sourceLine" id="cb29-12" title="12">})</a>
<a class="sourceLine" id="cb29-13" title="13"></a>
<a class="sourceLine" id="cb29-14" title="14"><span class="co"># get real speed</span></a>
<a class="sourceLine" id="cb29-15" title="15">data[, speed <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">atl_get_speed</span>(data)]</a></code></pre></div>
<div id="comparing-median-aggregation-with-and-without-smoothing" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Comparing median aggregation with and without smoothing</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># now plot distribution of speed</span></a>
<a class="sourceLine" id="cb30-2" title="2">data_agg &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(list_of_agg)</a>
<a class="sourceLine" id="cb30-3" title="3"></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co"># show boxplot of speed</span></a>
<a class="sourceLine" id="cb30-5" title="5">fig_agg_speed &lt;-</a>
<a class="sourceLine" id="cb30-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(data_agg)<span class="op">+</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span></a>
<a class="sourceLine" id="cb30-8" title="8">               <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">quantile</span>(data<span class="op">$</span>speed, <span class="dt">na.rm =</span> T,</a>
<a class="sourceLine" id="cb30-9" title="9">                        <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.95</span>)),</a>
<a class="sourceLine" id="cb30-10" title="10">             <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> speed_agg_smooth,</a>
<a class="sourceLine" id="cb30-12" title="12">                <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(interval),</a>
<a class="sourceLine" id="cb30-13" title="13">                    <span class="dt">ymin =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>median <span class="op">-</span><span class="st"> </span>sd,</a>
<a class="sourceLine" id="cb30-14" title="14">                    <span class="dt">ymax =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>median <span class="op">+</span><span class="st"> </span>sd),</a>
<a class="sourceLine" id="cb30-15" title="15">                <span class="dt">width =</span> <span class="fl">0.2</span>,</a>
<a class="sourceLine" id="cb30-16" title="16">                <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">0.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-17" title="17"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> speed_agg_smooth,</a>
<a class="sourceLine" id="cb30-18" title="18">             <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(interval),</a>
<a class="sourceLine" id="cb30-19" title="19">                 <span class="dt">y =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>median),</a>
<a class="sourceLine" id="cb30-20" title="20">             <span class="dt">shape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb30-21" title="21">             <span class="dt">size =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb30-22" title="22">             <span class="dt">fill =</span> pal[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb30-23" title="23">             <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">0.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-24" title="24"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="kw">factor</span>(interval), <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>speed),</a>
<a class="sourceLine" id="cb30-25" title="25">               <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">-0.25</span>,),</a>
<a class="sourceLine" id="cb30-26" title="26">               <span class="dt">fill =</span> pal[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb30-27" title="27">               <span class="dt">alpha =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb30-28" title="28">               <span class="dt">show.legend =</span> F, </a>
<a class="sourceLine" id="cb30-29" title="29">               <span class="dt">width =</span> <span class="fl">0.25</span>, </a>
<a class="sourceLine" id="cb30-30" title="30">               <span class="dt">outlier.size =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb30-31" title="31"><span class="st">  </span><span class="kw">scale_y_log10</span>(<span class="dt">label =</span> scales<span class="op">::</span>comma,</a>
<a class="sourceLine" id="cb30-32" title="32">                <span class="dt">limits =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="fl">1.005</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb30-33" title="33"><span class="st">  </span>ggthemes<span class="op">::</span><span class="kw">theme_few</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb30-34" title="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb30-35" title="35"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;interval (s)&quot;</span>,</a>
<a class="sourceLine" id="cb30-36" title="36">       <span class="dt">y =</span> <span class="st">&quot;speed&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># make combined figure</span></a>
<a class="sourceLine" id="cb31-2" title="2">fig_aggregate &lt;-</a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">  </span><span class="kw">wrap_plots</span>(<span class="kw">append</span>(fig_agg_data[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>], <span class="kw">list</span>(fig_agg_speed)),</a>
<a class="sourceLine" id="cb31-4" title="4">             <span class="dt">design =</span> <span class="st">&quot;AABBC&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="st">  </span><span class="kw">plot_annotation</span>(<span class="dt">tag_levels =</span> <span class="st">&quot;a&quot;</span>,</a>
<a class="sourceLine" id="cb31-6" title="6">                  <span class="dt">tag_prefix =</span> <span class="st">&quot;(&quot;</span>,</a>
<a class="sourceLine" id="cb31-7" title="7">                  <span class="dt">tag_suffix =</span> <span class="st">&quot;)&quot;</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.tag =</span> <span class="kw">element_text</span>(<span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</a>
<a class="sourceLine" id="cb31-9" title="9"></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="co"># save figure</span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="kw">ggsave</span>(fig_aggregate,</a>
<a class="sourceLine" id="cb31-12" title="12">       <span class="dt">filename =</span> <span class="st">&quot;figures/fig_aggregate_errors.png&quot;</span>,</a>
<a class="sourceLine" id="cb31-13" title="13">       <span class="dt">width =</span> <span class="dv">170</span>, <span class="dt">height =</span> <span class="dv">85</span>, <span class="dt">units =</span> <span class="st">&quot;mm&quot;</span>)</a></code></pre></div>
<p><img src="figures/fig_aggregate_errors.png" /></p>
<p>Thinning a movement track using median aggregation preserves track structure, but affects essential track metrics such as speed.
<strong>(a, b)</strong> Movement tracks with a canonical interval of 1s aggregated over intervals of <strong>(a)</strong> 10 and <strong>(b)</strong> 30 seconds, without removing large- or small-scale positioning errors. All symbols represent positions in the aggregated track, with the size of the symbol representing the standard deviation at each position.
Blue crosses represent positions with speed <span class="math inline">\(\leq\)</span> the 95^th percentile of canonical speeds, while red triangles represent positions with speed <span class="math inline">\(\geq\)</span> 95^th percentile of canonical speeds.
<strong>(c)</strong> Boxplot of instantaneous speeds after median aggregation of a 1s interval track over intervals of 3, 10, 30, and 120 seconds, but without the removal of positioning errors. The mean and 95^th percentile of speed in the canonical track are shown as solid and dashed lines, respectively.
Aggregation without reducing positioning errors can result in speed estimates that are substantially different from the true speed.</p>

</div>
</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-noonan2019">
<p>Noonan, Michael J., Christen H. Fleming, Thomas S. Akre, Jonathan Drescher-Lehman, Eliezer Gurarie, Autumn-Lynn Harrison, Roland Kays, and Justin M. Calabrese. 2019. “Scale-Insensitive Estimation of Speed and Distance Traveled from Animal Tracking Data.” <em>Movement Ecology</em> 7 (1): 35. <a href="https://doi.org/10.1186/s40462-019-0177-1">https://doi.org/10.1186/s40462-019-0177-1</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reducing-large-scale-positioning-error-by-filtering-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="residence-patches-and-their-construction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
