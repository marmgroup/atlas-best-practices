<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data</title>
  <meta name="description" content="Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data" />
  <meta name="github-repo" content="pratikunterwegs/atlas-best-practices" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data" />
  
  <meta name="twitter:description" content="Section 2 Processing Egyptian Fruit Bat Tracks | Supplementary Material for A Guide to Pre-processing High-Frequency Animal Tracking Data" />
  

<meta name="author" content="Pratik R. Gupte" />
<meta name="author" content="Christine E. Beardsworth" />
<meta name="author" content="Orr Spiegel" />
<meta name="author" content="Emmanuel Lourie" />
<meta name="author" content="Sivan Toledo" />
<meta name="author" content="Ran Nathan" />
<meta name="author" content="Allert I. Bijleveld" />


<meta name="date" content="2021-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="validating-the-residence-patch-method-with-calibration-data.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html"><i class="fa fa-check"></i><b>1</b> Validating the Residence Patch Method with Calibration Data</a><ul>
<li class="chapter" data-level="1.1" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#outline-of-cleaning-steps"><i class="fa fa-check"></i><b>1.1</b> Outline of Cleaning Steps</a></li>
<li class="chapter" data-level="1.2" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#install-atlastools-from-github"><i class="fa fa-check"></i><b>1.2</b> Install <code>atlastools</code> from Github</a><ul>
<li><a href="validating-the-residence-patch-method-with-calibration-data.html#a-note-on">A Note on <code>:=</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#prepare-libraries"><i class="fa fa-check"></i><b>1.3</b> Prepare libraries</a></li>
<li class="chapter" data-level="1.4" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#access-data-and-preliminary-visualisation"><i class="fa fa-check"></i><b>1.4</b> Access data and preliminary visualisation</a></li>
<li class="chapter" data-level="1.5" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#filter-by-bounding-box"><i class="fa fa-check"></i><b>1.5</b> Filter by bounding box</a></li>
<li class="chapter" data-level="1.6" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#filter-trajectories"><i class="fa fa-check"></i><b>1.6</b> Filter trajectories</a><ul>
<li class="chapter" data-level="1.6.1" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#handle-time"><i class="fa fa-check"></i><b>1.6.1</b> Handle time</a></li>
<li class="chapter" data-level="1.6.2" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#add-speed-and-turning-angle"><i class="fa fa-check"></i><b>1.6.2</b> Add speed and turning angle</a></li>
<li class="chapter" data-level="1.6.3" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#get-90th-percentile-of-speed-and-angle"><i class="fa fa-check"></i><b>1.6.3</b> Get 90th percentile of speed and angle</a></li>
<li class="chapter" data-level="1.6.4" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#filter-on-speed"><i class="fa fa-check"></i><b>1.6.4</b> Filter on speed</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#smoothing-the-trajectory"><i class="fa fa-check"></i><b>1.7</b> Smoothing the trajectory</a></li>
<li class="chapter" data-level="1.8" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#thinning-the-data"><i class="fa fa-check"></i><b>1.8</b> Thinning the data</a></li>
<li class="chapter" data-level="1.9" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#residence-patches"><i class="fa fa-check"></i><b>1.9</b> Residence patches</a><ul>
<li class="chapter" data-level="1.9.1" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#get-waypoint-centroids"><i class="fa fa-check"></i><b>1.9.1</b> Get waypoint centroids</a></li>
<li class="chapter" data-level="1.9.2" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#prepare-data"><i class="fa fa-check"></i><b>1.9.2</b> Prepare data</a></li>
<li class="chapter" data-level="1.9.3" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#exclude-transit-points"><i class="fa fa-check"></i><b>1.9.3</b> Exclude transit points</a></li>
<li class="chapter" data-level="1.9.4" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#run-residence-patch-method"><i class="fa fa-check"></i><b>1.9.4</b> Run residence patch method</a></li>
<li class="chapter" data-level="" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#a-note-on-summary-statistics"><i class="fa fa-check"></i>A note on summary statistics</a></li>
<li class="chapter" data-level="1.9.5" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#get-spatial-and-summary-objects"><i class="fa fa-check"></i><b>1.9.5</b> Get spatial and summary objects</a></li>
<li class="chapter" data-level="1.9.6" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#prepare-to-plot-data"><i class="fa fa-check"></i><b>1.9.6</b> Prepare to plot data</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#compare-patch-metrics"><i class="fa fa-check"></i><b>1.10</b> Compare patch metrics</a><ul>
<li class="chapter" data-level="1.10.1" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#linear-model-durations"><i class="fa fa-check"></i><b>1.10.1</b> Linear model durations</a></li>
<li class="chapter" data-level="1.10.2" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#linear-model-summary"><i class="fa fa-check"></i><b>1.10.2</b> Linear model summary</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="validating-the-residence-patch-method-with-calibration-data.html"><a href="validating-the-residence-patch-method-with-calibration-data.html#main-text-figure-7"><i class="fa fa-check"></i><b>1.11</b> Main text Figure 7</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html"><i class="fa fa-check"></i><b>2</b> Processing Egyptian Fruit Bat Tracks</a><ul>
<li class="chapter" data-level="2.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#prepare-libraries-1"><i class="fa fa-check"></i><b>2.1</b> Prepare libraries</a></li>
<li class="chapter" data-level="2.2" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#read-bat-data"><i class="fa fa-check"></i><b>2.2</b> Read bat data</a></li>
<li class="chapter" data-level="2.3" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#exploratory-data-analysis-panels-main-text-figure-1"><i class="fa fa-check"></i><b>2.3</b> Exploratory Data Analysis Panels: Main Text Figure 1</a><ul>
<li class="chapter" data-level="2.3.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#heatmap-of-locations"><i class="fa fa-check"></i><b>2.3.1</b> Heatmap of Locations</a></li>
<li class="chapter" data-level="2.3.2" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#sampling-intervals"><i class="fa fa-check"></i><b>2.3.2</b> Sampling Intervals</a></li>
<li class="chapter" data-level="2.3.3" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#localisation-error-measured-by-systems"><i class="fa fa-check"></i><b>2.3.3</b> Localisation Error Measured by Systems</a></li>
<li class="chapter" data-level="2.3.4" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#plot-paths-from-raw-tracking-data"><i class="fa fa-check"></i><b>2.3.4</b> Plot paths from raw tracking data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#prepare-data-for-filtering"><i class="fa fa-check"></i><b>2.4</b> Prepare data for filtering</a><ul>
<li class="chapter" data-level="2.4.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#prepare-data-per-individual"><i class="fa fa-check"></i><b>2.4.1</b> Prepare data per individual</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#filter-by-system-generated-error-attributes"><i class="fa fa-check"></i><b>2.5</b> Filter by system-generated error attributes</a><ul>
<li class="chapter" data-level="2.5.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#sanity-check-plot-filtered-data"><i class="fa fa-check"></i><b>2.5.1</b> Sanity check: Plot filtered data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#filter-by-speed"><i class="fa fa-check"></i><b>2.6</b> Filter by speed</a><ul>
<li class="chapter" data-level="2.6.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#sanity-check-plot-speed-filtered-data"><i class="fa fa-check"></i><b>2.6.1</b> Sanity check: Plot speed filtered data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#median-smoothing"><i class="fa fa-check"></i><b>2.7</b> Median smoothing</a><ul>
<li class="chapter" data-level="2.7.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#sanity-check-plot-smoothed-data"><i class="fa fa-check"></i><b>2.7.1</b> Sanity check: Plot smoothed data</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#making-residence-patches"><i class="fa fa-check"></i><b>2.8</b> Making residence patches</a><ul>
<li class="chapter" data-level="2.8.1" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#calculating-residence-time"><i class="fa fa-check"></i><b>2.8.1</b> Calculating residence time</a></li>
<li class="chapter" data-level="2.8.2" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#movements-away-from-the-roost"><i class="fa fa-check"></i><b>2.8.2</b> Movements away from the roost</a></li>
<li class="chapter" data-level="2.8.3" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#split-data-by-night-id"><i class="fa fa-check"></i><b>2.8.3</b> Split data by night-id</a></li>
<li class="chapter" data-level="2.8.4" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#constructing-residence-patches"><i class="fa fa-check"></i><b>2.8.4</b> Constructing residence patches</a></li>
<li class="chapter" data-level="2.8.5" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#getting-residence-patch-data"><i class="fa fa-check"></i><b>2.8.5</b> Getting residence patch data</a></li>
<li class="chapter" data-level="2.8.6" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#write-patch-spatial-representations"><i class="fa fa-check"></i><b>2.8.6</b> Write patch spatial representations</a></li>
<li class="chapter" data-level="2.8.7" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#duration-at-foraging-sites"><i class="fa fa-check"></i><b>2.8.7</b> Duration at foraging sites</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="processing-egyptian-fruit-bat-tracks.html"><a href="processing-egyptian-fruit-bat-tracks.html#main-text-figure-8"><i class="fa fa-check"></i><b>2.9</b> Main text Figure 8</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>3</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Supplementary Material for <em>A Guide to Pre-processing High-Frequency Animal Tracking Data</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="processing-egyptian-fruit-bat-tracks" class="section level1">
<h1><span class="header-section-number">Section 2</span> Processing Egyptian Fruit Bat Tracks</h1>
<p>We show the pre-processing pipeline at work on the tracks of three Egyptian fruit bats (<em>Rousettus aegyptiacus</em>), and construct residence patches.</p>
<div id="prepare-libraries-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Prepare libraries</h2>
<p>Install the required <code>R</code> libraries that are required from CRAN if not already installed.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># libs for data</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">library</span>(data.table)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">library</span>(RSQLite)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="kw">library</span>(atlastools)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5"></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co"># libs for plotting</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co"># recursion analysis</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="kw">library</span>(recurse)</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13"><span class="co"># prepare a palette</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14">pal &lt;-<span class="st"> </span>pals<span class="op">::</span><span class="kw">kovesi.rainbow_bgyr_35_85_c73</span>(<span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(remotes)) {</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  <span class="kw">install.packages</span>(<span class="st">&quot;remotes&quot;</span>, <span class="dt">repos =</span> <span class="st">&quot;http://cran.us.r-project.org&quot;</span>)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co"># installation using remotes</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(atlastools)) {</a>
<a class="sourceLine" id="cb24-7" data-line-number="7">  remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;pratikunterwegs/atlastools&quot;</span>, <span class="dt">upgrade =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb24-8" data-line-number="8">}</a></code></pre></div>
</div>
<div id="read-bat-data" class="section level2">
<h2><span class="header-section-number">2.2</span> Read bat data</h2>
<p>Read the bat data from an <code>SQLite</code> database local file and convert to a plain text csv file.
This data can be found in the “data” folder.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># prepare the connection</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">  <span class="dt">drv =</span> <span class="kw">SQLite</span>(),</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  <span class="dt">dbname =</span> <span class="st">&quot;data/Three_example_bats.sql&quot;</span></a>
<a class="sourceLine" id="cb25-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6"></a>
<a class="sourceLine" id="cb25-7" data-line-number="7"><span class="co"># list the tables</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8">table_name &lt;-<span class="st"> </span><span class="kw">dbListTables</span>(con)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9"></a>
<a class="sourceLine" id="cb25-10" data-line-number="10"><span class="co"># prepare to query all tables</span></a>
<a class="sourceLine" id="cb25-11" data-line-number="11">query &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;select * from </span><span class="ch">\&quot;</span><span class="st">%s</span><span class="ch">\&quot;</span><span class="st">&#39;</span>, table_name)</a>
<a class="sourceLine" id="cb25-12" data-line-number="12"></a>
<a class="sourceLine" id="cb25-13" data-line-number="13"><span class="co"># query the database</span></a>
<a class="sourceLine" id="cb25-14" data-line-number="14">data &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(<span class="dt">conn =</span> con, <span class="dt">statement =</span> query)</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16"><span class="co"># disconnect from database</span></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="kw">dbDisconnect</span>(con)</a></code></pre></div>
<p>Convert data to csv, and save a local copy in the folder “data”.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># convert data to datatable</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw">setDT</span>(data)</a>
<a class="sourceLine" id="cb26-3" data-line-number="3"></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co"># write data for QGIS</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw">fwrite</span>(data, <span class="dt">file =</span> <span class="st">&quot;data/bat_data.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="exploratory-data-analysis-panels-main-text-figure-1" class="section level2">
<h2><span class="header-section-number">2.3</span> Exploratory Data Analysis Panels: Main Text Figure 1</h2>
<p>Here, we make some basic figures for exploratory data analysis shown in Figure 1 of the main text.</p>
<p>Plot the bat data as a sanity check, and inspect it visually for errors.
The plot code is hidden in the rendered copy (PDF) of this supplementary material, but is available in the <code>Rmarkdown</code> file “supplement/06_bat_data.Rmd”.</p>
<div id="heatmap-of-locations" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Heatmap of Locations</h3>
<p>Here we demonstrate a basic heatmap of locations, aggregating over all individuals.
In this one instance, the plotting code is also shown as a guide for readers, but in general, plotting code is hidden throughout this document.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">data_heatmap &lt;-<span class="st"> </span><span class="kw">copy</span>(data)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">data_heatmap[, <span class="kw">c</span>(<span class="st">&quot;xround&quot;</span>, <span class="st">&quot;yround&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">  plyr<span class="op">::</span><span class="kw">round_any</span>(X, <span class="dv">250</span>),</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">  plyr<span class="op">::</span><span class="kw">round_any</span>(Y, <span class="dv">250</span>)</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">)]</a>
<a class="sourceLine" id="cb27-6" data-line-number="6">data_heatmap &lt;-<span class="st"> </span>data_heatmap[, .N, by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;xround&quot;</span>, <span class="st">&quot;yround&quot;</span>)]</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">fig_heatmap &lt;-</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(data_heatmap) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_tile</span>(</a>
<a class="sourceLine" id="cb28-4" data-line-number="4">    <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb28-5" data-line-number="5">      xround, yround,</a>
<a class="sourceLine" id="cb28-6" data-line-number="6">      <span class="dt">fill =</span> N</a>
<a class="sourceLine" id="cb28-7" data-line-number="7">    ),</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">    <span class="dt">size =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">    <span class="dt">show.legend =</span> F</a>
<a class="sourceLine" id="cb28-10" data-line-number="10">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(</a>
<a class="sourceLine" id="cb28-12" data-line-number="12">    <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb28-13" data-line-number="13">    <span class="dt">direction =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb28-14" data-line-number="14">    <span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">2039</span>)</a>
<a class="sourceLine" id="cb28-18" data-line-number="18"></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"><span class="kw">ggsave</span>(fig_heatmap,</a>
<a class="sourceLine" id="cb28-20" data-line-number="20">  <span class="dt">filename =</span> <span class="st">&quot;supplement/figures/fig_bat_heatmap_raw.png&quot;</span>,</a>
<a class="sourceLine" id="cb28-21" data-line-number="21">  <span class="dt">dpi =</span> <span class="dv">300</span>,</a>
<a class="sourceLine" id="cb28-22" data-line-number="22">  <span class="dt">width =</span> <span class="dv">6</span>, <span class="dt">height =</span> <span class="dv">4</span></a>
<a class="sourceLine" id="cb28-23" data-line-number="23">)</a></code></pre></div>
</div>
<div id="sampling-intervals" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Sampling Intervals</h3>
<p>Here, we create the histogram of sampling intervals shown in Figure 1 of the main text.
The plotting code is hidden in the PDF version, but available in the source code.</p>
</div>
<div id="localisation-error-measured-by-systems" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Localisation Error Measured by Systems</h3>
<p>Here, we create the histogram of location error (variance in X) <span class="citation">(Weiser et al. <a href="#ref-weiser2016">2016</a>)</span> shown in Figure 1 of the main text.
The plotting code is hidden in the PDF version, but available in the source code.</p>
</div>
<div id="plot-paths-from-raw-tracking-data" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Plot paths from raw tracking data</h3>
<p>Here, we plot the paths of individual bats from the raw tracking data to visually inspect them for errors.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co"># this figure for the panel in main text figure 1</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">fig_bat_focus_bad_speed &lt;-</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span>fig_bat_raw <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_sf</span>(</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">    <span class="dt">crs =</span> <span class="dv">2039</span>,</a>
<a class="sourceLine" id="cb29-6" data-line-number="6">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">253000</span>, <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb29-7" data-line-number="7">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">772000</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb29-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb29-9" data-line-number="9"></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="co"># save to supplement figures</span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="kw">ggsave</span>(fig_bat_focus_bad_speed,</a>
<a class="sourceLine" id="cb29-12" data-line-number="12">  <span class="dt">filename =</span> <span class="st">&quot;supplement/figures/fig_bat_focus_bad_speed.png&quot;</span>,</a>
<a class="sourceLine" id="cb29-13" data-line-number="13">  <span class="dt">dpi =</span> <span class="dv">300</span>,</a>
<a class="sourceLine" id="cb29-14" data-line-number="14">  <span class="dt">width =</span> <span class="dv">4</span>, <span class="dt">height =</span> <span class="dv">6</span></a>
<a class="sourceLine" id="cb29-15" data-line-number="15">)</a></code></pre></div>
<div class="figure">
<img src="figures/fig_bat_raw.png" alt="Movement data from three Egyptian fruit bats tracked using the ATLAS system (Rousettus aegyptiacus; (Toledo et al. 2020; Shohami and Nathan 2020)). The bats were tracked in the Hula Valley, Israel (33.1^{\circ}N, 35.6^{\circ}E), and we use three nights of tracking (5, 6, and 7 May, 2018), for our demonstration, with an average of 13,370 positions (SD = 2,173; range = 11,195 – 15,542; interval = 8 seconds) per individual. After first plotting the individual tracks, we notice severe distortions, making pre-processing necesary" />
<p class="caption">Movement data from three Egyptian fruit bats tracked using the ATLAS system (<em>Rousettus aegyptiacus</em>; <span class="citation">(Toledo et al. <a href="#ref-toledo2020">2020</a>; Shohami and Nathan <a href="#ref-shohami2020">2020</a>)</span>).
The bats were tracked in the Hula Valley, Israel (33.1<span class="math inline">\(^{\circ}\)</span>N, 35.6<span class="math inline">\(^{\circ}\)</span>E), and we use three nights of tracking (5, 6, and 7 May, 2018), for our demonstration, with an average of 13,370 positions (SD = 2,173; range = 11,195 – 15,542; interval = 8 seconds) per individual.
After first plotting the individual tracks, we notice severe distortions, making pre-processing necesary</p>
</div>
</div>
</div>
<div id="prepare-data-for-filtering" class="section level2">
<h2><span class="header-section-number">2.4</span> Prepare data for filtering</h2>
<p>Here we apply a series of simple filters.
It is always safer to deal with one individual at a time, so we split the data.table
into a list of data.tables to avoid mixups among individuals.</p>
<p>This is a very rudimentary demonstration of the principle behind <strong>batch processing</strong> — splitting data into smaller, independent subsets, and applying the same steps to each subset.</p>
<div id="prepare-data-per-individual" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Prepare data per individual</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># split bat data by tag</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="co"># first make a copy using the data.table function copy</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co"># this prevents the orignal data from being modified by atlastools</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co"># functions which DO MODIFY BY REFERENCE!</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">data_split &lt;-<span class="st"> </span><span class="kw">copy</span>(data)</a>
<a class="sourceLine" id="cb30-6" data-line-number="6"></a>
<a class="sourceLine" id="cb30-7" data-line-number="7"><span class="co"># now split</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8">data_split &lt;-<span class="st"> </span><span class="kw">split</span>(data_split, <span class="dt">by =</span> <span class="st">&quot;TAG&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="filter-by-system-generated-error-attributes" class="section level2">
<h2><span class="header-section-number">2.5</span> Filter by system-generated error attributes</h2>
<p>No natural bounds suggest themselves, so instead we proceed to filter by system-generated attributes of error, since point outliers are obviously visible.</p>
<p>We use filter out positions with <code>SD &gt; 20</code> and positions calculated using only 3 base stations, using the function <code>atl_filter_covariates</code>.</p>
<p>First we calculate the variable <code>SD</code>, which for ATLAS systems is calculated as:</p>
<p><span class="math display">\[SD = \sqrt{{VARX} + {VARY} + 2 \times {COVXY}}\]</span></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="co"># get SD.</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="co"># since the data are data.tables, no assignment is necessary</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="kw">invisible</span>(</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">  <span class="kw">lapply</span>(data_split, <span class="cf">function</span>(dt) {</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">    dt[, SD <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">sqrt</span>(VARX <span class="op">+</span><span class="st"> </span>VARY <span class="op">+</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>COVXY))]</a>
<a class="sourceLine" id="cb31-6" data-line-number="6">  })</a>
<a class="sourceLine" id="cb31-7" data-line-number="7">)</a></code></pre></div>
<p>Then we pass the filters to <code>atl_filter_covariates</code>.
We apply the filter to each individual’s data using an <code>lapply</code> – this separates the data from each individual into a separate data frame, lessening the chances of inter-individual mix-ups.</p>
<p>This is another basic example of the principles behind batch-processing, and could be parallelised using the <code>R</code> package <code>furrr</code> (see <a href="https://CRAN.R-project.org/package=furrr" class="uri">https://CRAN.R-project.org/package=furrr</a>).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="co"># filter for SD &lt;= 20</span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="co"># here, reassignment is necessary as rows are being removed</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">data_split &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_split, <span class="cf">function</span>(dt) {</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">  dt &lt;-<span class="st"> </span><span class="kw">atl_filter_covariates</span>(</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">    <span class="dt">data =</span> dt,</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">    <span class="dt">filters =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb32-7" data-line-number="7">      <span class="st">&quot;SD &lt;= 20&quot;</span>,</a>
<a class="sourceLine" id="cb32-8" data-line-number="8">      <span class="st">&quot;NBS &gt; 3&quot;</span></a>
<a class="sourceLine" id="cb32-9" data-line-number="9">    )</a>
<a class="sourceLine" id="cb32-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb32-11" data-line-number="11">})</a></code></pre></div>
<div id="sanity-check-plot-filtered-data" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Sanity check: Plot filtered data</h3>
<p>We plot the data to check whether the filtering has improved the data (Fig. 2.2).
The plot code is once again hidden in this rendering, but is available in the source code file.</p>
<div class="figure">
<img src="figures/fig_bat_filter_cov.png" alt="Bat data filtered for large location errors, removing observations with standard deviation &gt; 20. Grey crosses show data that were removed. Since the number of base stations used in the location process is a good indicator of error (Weiser et al. 2016), we also removed observations calculated using fewer than four base stations. Both steps used the function . This filtering reduced the data to an average of 10,447 positions per individual (78% of the raw data on average). However, some point outliers remain." />
<p class="caption">Bat data filtered for large location errors, removing observations with standard deviation <span class="math inline">\(&gt;\)</span> 20. Grey crosses show data that were removed. Since the number of base stations used in the location process is a good indicator of error <span class="citation">(Weiser et al. <a href="#ref-weiser2016">2016</a>)</span>, we also removed observations calculated using fewer than four base stations. Both steps used the function .
This filtering reduced the data to an average of 10,447 positions per individual (78% of the raw data on average). However, some point outliers remain.</p>
</div>
</div>
</div>
<div id="filter-by-speed" class="section level2">
<h2><span class="header-section-number">2.6</span> Filter by speed</h2>
<p>Some point outliers remain, and could be removed using a speed filter.</p>
<p>First we calculate speeds, using <code>atl_get_speed</code>. We must assign the speed output to a new column in the data.table, which has a special syntax which modifies in place, and is shown below. This syntax is a feature of the <code>data.table</code> package, not strictly of <code>atlastools</code> <span class="citation">(Dowle and Srinivasan <a href="#ref-dowle2020">2020</a>)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># get speeds as with SD, no reassignment required for columns</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">invisible</span>(</a>
<a class="sourceLine" id="cb33-3" data-line-number="3">  <span class="kw">lapply</span>(data_split, <span class="cf">function</span>(dt) {</a>
<a class="sourceLine" id="cb33-4" data-line-number="4"></a>
<a class="sourceLine" id="cb33-5" data-line-number="5">    <span class="co"># first process time to seconds</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6">    <span class="co"># assign to a new column</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7">    dt[, time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">floor</span>(TIME <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)]</a>
<a class="sourceLine" id="cb33-8" data-line-number="8"></a>
<a class="sourceLine" id="cb33-9" data-line-number="9">    dt[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(</a>
<a class="sourceLine" id="cb33-10" data-line-number="10">      <span class="dt">speed_in =</span> <span class="kw">atl_get_speed</span>(dt,</a>
<a class="sourceLine" id="cb33-11" data-line-number="11">        <span class="dt">x =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Y&quot;</span>,</a>
<a class="sourceLine" id="cb33-12" data-line-number="12">        <span class="dt">time =</span> <span class="st">&quot;time&quot;</span>,</a>
<a class="sourceLine" id="cb33-13" data-line-number="13">        <span class="dt">type =</span> <span class="st">&quot;in&quot;</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14">      ),</a>
<a class="sourceLine" id="cb33-15" data-line-number="15">      <span class="dt">speed_out =</span> <span class="kw">atl_get_speed</span>(dt,</a>
<a class="sourceLine" id="cb33-16" data-line-number="16">        <span class="dt">x =</span> <span class="st">&quot;X&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Y&quot;</span>,</a>
<a class="sourceLine" id="cb33-17" data-line-number="17">        <span class="dt">time =</span> <span class="st">&quot;time&quot;</span>,</a>
<a class="sourceLine" id="cb33-18" data-line-number="18">        <span class="dt">type =</span> <span class="st">&quot;out&quot;</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19">      )</a>
<a class="sourceLine" id="cb33-20" data-line-number="20">    )]</a>
<a class="sourceLine" id="cb33-21" data-line-number="21">  })</a>
<a class="sourceLine" id="cb33-22" data-line-number="22">)</a></code></pre></div>
<p>Now filter for speeds &gt; 20 m/s (around 70 km/h), passing the predicate (a statement return TRUE or FALSE) to <code>atl_filter_covariates</code>. First, we remove positions which have <code>NA</code> for their <code>speed_in</code> (the first position) and their <code>speed_out</code> (last position).</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="co"># filter speeds</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="co"># reassignment is required here</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">data_split &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_split, <span class="cf">function</span>(dt) {</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">  dt &lt;-<span class="st"> </span><span class="kw">na.omit</span>(dt, <span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;speed_in&quot;</span>, <span class="st">&quot;speed_out&quot;</span>))</a>
<a class="sourceLine" id="cb34-5" data-line-number="5"></a>
<a class="sourceLine" id="cb34-6" data-line-number="6">  dt &lt;-<span class="st"> </span><span class="kw">atl_filter_covariates</span>(</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">    <span class="dt">data =</span> dt,</a>
<a class="sourceLine" id="cb34-8" data-line-number="8">    <span class="dt">filters =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb34-9" data-line-number="9">      <span class="st">&quot;speed_in &lt;= 20&quot;</span>,</a>
<a class="sourceLine" id="cb34-10" data-line-number="10">      <span class="st">&quot;speed_out &lt;= 20&quot;</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11">    )</a>
<a class="sourceLine" id="cb34-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb34-13" data-line-number="13">})</a></code></pre></div>
<div id="sanity-check-plot-speed-filtered-data" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Sanity check: Plot speed filtered data</h3>
<p>The speed filtered data is now inspected for errors (Fig. 2.3). The plot code is once again hidden.</p>
<div class="figure">
<img src="figures/fig_bat_filter_speed.png" alt="Bat data with unrealistic speeds removed. Notice, compared with the previous figure, that spikes of unrealistic movement in all three tracks have been removed. Grey crosses show data that were removed. We calculated the incoming and outgoing speed of each position using atl_get_speed, and filtered out positions with speeds &gt; 20 m/s using atl_filter_covariates, leaving 10,337 positions per individual on average (98% from the previous step)." />
<p class="caption">Bat data with unrealistic speeds removed. Notice, compared with the previous figure, that spikes of unrealistic movement in all three tracks have been removed. Grey crosses show data that were removed. We calculated the incoming and outgoing speed of each position using <code>atl_get_speed</code>, and filtered out positions with speeds &gt; 20 m/s using <code>atl_filter_covariates</code>, leaving 10,337 positions per individual on average (98% from the previous step).</p>
</div>
</div>
</div>
<div id="median-smoothing" class="section level2">
<h2><span class="header-section-number">2.7</span> Median smoothing</h2>
<p>The quality of the data is relatively high, and a median smooth is not strictly necessary. We demonstrate the application of a 5 point median smooth to the data nonetheless (Fig. 2.4).</p>
<p>Since the median smoothing function <code>atl_median_smooth</code> modifies in place, we first make a copy of the data, using <code>data.table</code>’s <code>copy</code> function.
No reassignment is required, in this case. The <code>lapply</code> function allows arguments to <code>atl_median_smooth</code> to be passed within <code>lapply</code> itself.</p>
<p>In this case, the same moving window <span class="math inline">\(K\)</span> is applied to all individuals, but modifying this code to use the multivariate version <code>Map</code> allows different <span class="math inline">\(K\)</span> to be used for different individuals. This is a programming matter, and is not covered here further.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># since the function modifies in place, we shall make a copy</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2">data_smooth &lt;-<span class="st"> </span><span class="kw">copy</span>(data_split)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co"># split the data again</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5">data_smooth &lt;-<span class="st"> </span><span class="kw">split</span>(data_smooth, <span class="dt">by =</span> <span class="st">&quot;TAG&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># apply the median smooth to each list element</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co"># no reassignment is required as THE FUNCTION MODIFIES IN PLACE!</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">invisible</span>(</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"></a>
<a class="sourceLine" id="cb36-5" data-line-number="5">  <span class="co"># the function arguments to atl_median_smooth</span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6">  <span class="co"># can be passed directly in lapply</span></a>
<a class="sourceLine" id="cb36-7" data-line-number="7"></a>
<a class="sourceLine" id="cb36-8" data-line-number="8">  <span class="kw">lapply</span>(</a>
<a class="sourceLine" id="cb36-9" data-line-number="9">    <span class="dt">X =</span> data_smooth,</a>
<a class="sourceLine" id="cb36-10" data-line-number="10">    <span class="dt">FUN =</span> atl_median_smooth,</a>
<a class="sourceLine" id="cb36-11" data-line-number="11">    <span class="dt">time =</span> <span class="st">&quot;time&quot;</span>, <span class="dt">moving_window =</span> <span class="dv">5</span></a>
<a class="sourceLine" id="cb36-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb36-13" data-line-number="13">)</a></code></pre></div>
<div id="sanity-check-plot-smoothed-data" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Sanity check: Plot smoothed data</h3>
<div class="figure">
<img src="figures/fig_bat_smooth.png" alt="Bat data after applying a median smooth with a moving window K = 5. Grey circles show data prior to smoothing. The smoothing step did not discard any data." />
<p class="caption">Bat data after applying a median smooth with a moving window <span class="math inline">\(K\)</span> = 5. Grey circles show data prior to smoothing. The smoothing step did not discard any data.</p>
</div>
</div>
</div>
<div id="making-residence-patches" class="section level2">
<h2><span class="header-section-number">2.8</span> Making residence patches</h2>
<div id="calculating-residence-time" class="section level3">
<h3><span class="header-section-number">2.8.1</span> Calculating residence time</h3>
<p>First, the data is put through the <code>recurse</code> package to get residence time <span class="citation">(Bracis, Bildstein, and Mueller <a href="#ref-bracis2018">2018</a>)</span>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co"># split the data</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2">data_smooth &lt;-<span class="st"> </span><span class="kw">split</span>(data_smooth, data_smooth<span class="op">$</span>TAG)</a></code></pre></div>
<p>We calculated residence time, but since bats may revisit the same features, we want to prevent confusion between frequent revisits and prolonged residence.</p>
<p>For this, we stop summing residence times within <span class="math inline">\(Z\)</span> metres of a location if the animal exited the area for one hour or more. The value of <span class="math inline">\(Z\)</span> (radius, in <code>recurse</code> parameter terms) was chosen as 50m.</p>
<p>This step is relatively complicated and is only required for individuals which frequently return to the same location, or pass over the same areas repeatedly, and for which revisits (cumulative time spent) may be confused for residence time in a single visit.</p>
<p>While a simpler implementation using total residence time divided by the number of revisits is also possible, this does assume that each revisit had the same residence time.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># get residence times</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">data_residence &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_smooth, <span class="cf">function</span>(dt) {</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4">  <span class="co"># do basic recurse -- refer to Bracis et al. (2018) Ecography</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5">  dt_recurse &lt;-<span class="st"> </span><span class="kw">getRecursions</span>(</a>
<a class="sourceLine" id="cb38-6" data-line-number="6">    <span class="dt">x =</span> dt[, <span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;TAG&quot;</span>)],</a>
<a class="sourceLine" id="cb38-7" data-line-number="7">    <span class="dt">radius =</span> <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb38-8" data-line-number="8">    <span class="dt">timeunits =</span> <span class="st">&quot;mins&quot;</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb38-10" data-line-number="10"></a>
<a class="sourceLine" id="cb38-11" data-line-number="11">  <span class="co"># get revisit stats column provided as recurse output</span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12">  dt_recurse &lt;-<span class="st"> </span><span class="kw">setDT</span>(</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">    dt_recurse[[<span class="st">&quot;revisitStats&quot;</span>]]</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">  )</a>
<a class="sourceLine" id="cb38-15" data-line-number="15"></a>
<a class="sourceLine" id="cb38-16" data-line-number="16">  <span class="co"># count long absences from the each position</span></a>
<a class="sourceLine" id="cb38-17" data-line-number="17">  dt_recurse[, timeSinceLastVisit <span class="op">:</span><span class="er">=</span></a>
<a class="sourceLine" id="cb38-18" data-line-number="18"><span class="st">    </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(timeSinceLastVisit), <span class="op">-</span><span class="ot">Inf</span>, timeSinceLastVisit)]</a>
<a class="sourceLine" id="cb38-19" data-line-number="19">  dt_recurse[, longAbsenceCounter <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">cumsum</span>(timeSinceLastVisit <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb38-20" data-line-number="20">    by =<span class="st"> </span>.(coordIdx)</a>
<a class="sourceLine" id="cb38-21" data-line-number="21">  ]</a>
<a class="sourceLine" id="cb38-22" data-line-number="22"></a>
<a class="sourceLine" id="cb38-23" data-line-number="23">  <span class="co"># filter data to exclude revisits after the first long absence of 60 mins</span></a>
<a class="sourceLine" id="cb38-24" data-line-number="24">  dt_recurse &lt;-<span class="st"> </span>dt_recurse[longAbsenceCounter <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb38-25" data-line-number="25"></a>
<a class="sourceLine" id="cb38-26" data-line-number="26">  <span class="co"># calculate the residence time as the sum of times inside</span></a>
<a class="sourceLine" id="cb38-27" data-line-number="27">  <span class="co"># before the first &#39;long absence&#39;</span></a>
<a class="sourceLine" id="cb38-28" data-line-number="28">  <span class="co"># also calculate the First Passage Time and the number of revisits</span></a>
<a class="sourceLine" id="cb38-29" data-line-number="29">  dt_recurse &lt;-<span class="st"> </span>dt_recurse[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb38-30" data-line-number="30">    <span class="dt">resTime =</span> <span class="kw">sum</span>(timeInside),</a>
<a class="sourceLine" id="cb38-31" data-line-number="31">    <span class="dt">fpt =</span> <span class="kw">first</span>(timeInside),</a>
<a class="sourceLine" id="cb38-32" data-line-number="32">    <span class="dt">revisits =</span> <span class="kw">max</span>(visitIdx)</a>
<a class="sourceLine" id="cb38-33" data-line-number="33">  ),</a>
<a class="sourceLine" id="cb38-34" data-line-number="34">  by =<span class="st"> </span>.(coordIdx, x, y)</a>
<a class="sourceLine" id="cb38-35" data-line-number="35">  ]</a>
<a class="sourceLine" id="cb38-36" data-line-number="36"></a>
<a class="sourceLine" id="cb38-37" data-line-number="37">  <span class="co"># prepare to merge existing data with recursion data</span></a>
<a class="sourceLine" id="cb38-38" data-line-number="38">  dt[, coordIdx <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">seq</span>(<span class="kw">nrow</span>(dt))]</a>
<a class="sourceLine" id="cb38-39" data-line-number="39"></a>
<a class="sourceLine" id="cb38-40" data-line-number="40">  <span class="co"># merge the revised recursion analysis data with the tracking data</span></a>
<a class="sourceLine" id="cb38-41" data-line-number="41">  dt &lt;-<span class="st"> </span><span class="kw">merge</span>(dt,</a>
<a class="sourceLine" id="cb38-42" data-line-number="42">    dt_recurse[, <span class="kw">c</span>(<span class="st">&quot;coordIdx&quot;</span>, <span class="st">&quot;resTime&quot;</span>)],</a>
<a class="sourceLine" id="cb38-43" data-line-number="43">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;coordIdx&quot;</span>)</a>
<a class="sourceLine" id="cb38-44" data-line-number="44">  )</a>
<a class="sourceLine" id="cb38-45" data-line-number="45"></a>
<a class="sourceLine" id="cb38-46" data-line-number="46">  <span class="co"># ensure the data are ordered in ascending order of time</span></a>
<a class="sourceLine" id="cb38-47" data-line-number="47">  <span class="kw">setorderv</span>(dt, <span class="st">&quot;time&quot;</span>)</a>
<a class="sourceLine" id="cb38-48" data-line-number="48"></a>
<a class="sourceLine" id="cb38-49" data-line-number="49">  <span class="co"># print message when done</span></a>
<a class="sourceLine" id="cb38-50" data-line-number="50">  <span class="kw">message</span>(<span class="kw">sprintf</span>(<span class="st">&quot;TAG %s residence times done&quot;</span>, <span class="kw">unique</span>(dt<span class="op">$</span>TAG)))</a>
<a class="sourceLine" id="cb38-51" data-line-number="51"></a>
<a class="sourceLine" id="cb38-52" data-line-number="52">  <span class="co"># return the dataframe</span></a>
<a class="sourceLine" id="cb38-53" data-line-number="53">  dt</a>
<a class="sourceLine" id="cb38-54" data-line-number="54">})</a></code></pre></div>
<p>We bind the data together and assign a human readable timestamp column.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># bind the list</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2">data_residence &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(data_residence)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="co"># get time as human readable</span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5">data_residence[, ts <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.POSIXct</span>(time, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>)]</a>
<a class="sourceLine" id="cb39-6" data-line-number="6"></a>
<a class="sourceLine" id="cb39-7" data-line-number="7"><span class="co"># get hour of day to filter for nighttime</span></a>
<a class="sourceLine" id="cb39-8" data-line-number="8">data_residence[, hour <span class="op">:</span><span class="er">=</span><span class="st"> </span>data.table<span class="op">::</span><span class="kw">hour</span>(ts)]</a></code></pre></div>
</div>
<div id="movements-away-from-the-roost" class="section level3">
<h3><span class="header-section-number">2.8.2</span> Movements away from the roost</h3>
<p>To focus on night-time bat foraging around fruit trees, we shall filter data <em>both</em> on the timestamps, to select night-time positions, and on the locations, to select positions &gt; 1 km away from the roost-cave at Har Gershom (see main text Fig. 8).</p>
<p>Combining these two filters allows us to exclude bat positions at the roost-cave that may be due to individual-differences in bats’ departure or return times to and from their foraging areas.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="co"># read in roosts and select the Har Gershom roost</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2">roosts &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="st">&quot;data/Roosts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb40-3" data-line-number="3"><span class="kw">setnames</span>(roosts, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;roost_name&quot;</span>)</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">roosts &lt;-<span class="st"> </span>roosts[roost_name <span class="op">==</span><span class="st"> &quot;Har Gershom&quot;</span>]</a>
<a class="sourceLine" id="cb40-5" data-line-number="5"></a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co"># define a simple distance function that is vectorised</span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7">get_distance_adhoc &lt;-<span class="st"> </span><span class="cf">function</span>(x1, y1, x2, y2) {</a>
<a class="sourceLine" id="cb40-8" data-line-number="8">  <span class="kw">sqrt</span>(((x2 <span class="op">-</span><span class="st"> </span>x1)<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>((y2 <span class="op">-</span><span class="st"> </span>y1)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb40-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb40-10" data-line-number="10"></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co"># calculate distance to roost cave at Har Gershom</span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12">data_residence[, distance_roost <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">get_distance_adhoc</span>(</a>
<a class="sourceLine" id="cb40-13" data-line-number="13">  <span class="dt">x1 =</span> roosts<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb40-14" data-line-number="14">  <span class="dt">x2 =</span> data_residence<span class="op">$</span>X,</a>
<a class="sourceLine" id="cb40-15" data-line-number="15">  <span class="dt">y1 =</span> roosts<span class="op">$</span>Y,</a>
<a class="sourceLine" id="cb40-16" data-line-number="16">  <span class="dt">y2 =</span> data_residence<span class="op">$</span>Y</a>
<a class="sourceLine" id="cb40-17" data-line-number="17">)]</a></code></pre></div>
<p>Users should plot the data to examine the effect of applying filters — this code is shown, but the figure is hidden for brevity.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co"># plot for sanity check --- this plot is not shown</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">fig_roost_exclude &lt;-</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(data_residence) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">    <span class="kw">aes</span>(X, Y, <span class="dt">col =</span> distance_roost)</a>
<a class="sourceLine" id="cb41-6" data-line-number="6">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb41-8" data-line-number="8">    <span class="dt">data =</span> roosts,</a>
<a class="sourceLine" id="cb41-9" data-line-number="9">    <span class="kw">aes</span>(X, Y),</a>
<a class="sourceLine" id="cb41-10" data-line-number="10">    <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb41-11" data-line-number="11">    <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb41-12" data-line-number="12">    <span class="dt">alpha =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb41-13" data-line-number="13">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_colour_viridis_c</span>(</a>
<a class="sourceLine" id="cb41-15" data-line-number="15">    <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb41-16" data-line-number="16">    <span class="dt">trans =</span> <span class="st">&quot;log10&quot;</span>,</a>
<a class="sourceLine" id="cb41-17" data-line-number="17">    <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">2500</span>, <span class="dv">5000</span>),</a>
<a class="sourceLine" id="cb41-18" data-line-number="18">    <span class="dt">labels =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb41-19" data-line-number="19">      scales<span class="op">::</span><span class="kw">comma</span>(</a>
<a class="sourceLine" id="cb41-20" data-line-number="20">        x,</a>
<a class="sourceLine" id="cb41-21" data-line-number="21">        <span class="dt">scale =</span> <span class="fl">0.001</span>, <span class="dt">suffix =</span> <span class="st">&quot;km&quot;</span></a>
<a class="sourceLine" id="cb41-22" data-line-number="22">      )</a>
<a class="sourceLine" id="cb41-23" data-line-number="23">    },</a>
<a class="sourceLine" id="cb41-24" data-line-number="24">    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1000</span>, <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb41-25" data-line-number="25">    <span class="dt">na.value =</span> <span class="st">&quot;lightblue&quot;</span></a>
<a class="sourceLine" id="cb41-26" data-line-number="26">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-27" data-line-number="27"><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-28" data-line-number="28"><span class="st">  </span><span class="kw">theme_test</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb41-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb41-30" data-line-number="30">    <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb41-31" data-line-number="31">    <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb41-32" data-line-number="32">    <span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>,</a>
<a class="sourceLine" id="cb41-33" data-line-number="33">    <span class="dt">legend.key.height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>),</a>
<a class="sourceLine" id="cb41-34" data-line-number="34">    <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">vjust =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-35" data-line-number="35">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-36" data-line-number="36"><span class="st">  </span><span class="kw">coord_sf</span>(</a>
<a class="sourceLine" id="cb41-37" data-line-number="37">    <span class="dt">crs =</span> <span class="dv">2039</span></a>
<a class="sourceLine" id="cb41-38" data-line-number="38">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb41-39" data-line-number="39"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb41-40" data-line-number="40">    <span class="dt">colour =</span> <span class="st">&quot;distance (km)&quot;</span></a>
<a class="sourceLine" id="cb41-41" data-line-number="41">  )</a></code></pre></div>
<p>We now filter the data to exclude both day-time data, as well as data that is &lt; 1 km from the roost.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co"># filter for hour between 8pm and 5am and distance &gt; 1km</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2">data_residence &lt;-<span class="st"> </span><span class="kw">atl_filter_covariates</span>(</a>
<a class="sourceLine" id="cb42-3" data-line-number="3">  <span class="dt">data =</span> data_residence,</a>
<a class="sourceLine" id="cb42-4" data-line-number="4">  <span class="dt">filters =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb42-5" data-line-number="5">    <span class="st">&quot;hour &gt; 20 | hour &lt; 5&quot;</span>,</a>
<a class="sourceLine" id="cb42-6" data-line-number="6">    <span class="st">&quot;distance_roost &gt; 1000&quot;</span></a>
<a class="sourceLine" id="cb42-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb42-8" data-line-number="8">)</a></code></pre></div>
</div>
<div id="split-data-by-night-id" class="section level3">
<h3><span class="header-section-number">2.8.3</span> Split data by night-id</h3>
<p>We assign a night-id to each position, i.e., the night-time spanning two calendar days. We then filter for data with a residence time &gt; 5 minutes, as we expect that a bat stopped at a location for more than 5 minutes is likely to be foraging.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="co"># split data into separate nights</span></a>
<a class="sourceLine" id="cb43-2" data-line-number="2">data_residence[, night <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">cumsum</span>(<span class="kw">diff</span>(hour) <span class="op">&gt;</span><span class="st"> </span><span class="dv">12</span>)), by =<span class="st"> &quot;TAG&quot;</span>]</a>
<a class="sourceLine" id="cb43-3" data-line-number="3"></a>
<a class="sourceLine" id="cb43-4" data-line-number="4"><span class="co"># filter for residence time &gt; 5 minutes</span></a>
<a class="sourceLine" id="cb43-5" data-line-number="5">data_residence &lt;-<span class="st"> </span>data_residence[resTime <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>, ]</a></code></pre></div>
</div>
<div id="constructing-residence-patches" class="section level3">
<h3><span class="header-section-number">2.8.4</span> Constructing residence patches</h3>
<p>Some preparation is required. First, the function requires columns <code>x</code>, <code>y</code>,
<code>time</code>, and <code>id</code>, which we assign using the <code>data.table</code> syntax. The <code>time</code> column is already present, but the other columns need to be renamed to lower case.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="co"># add an id column</span></a>
<a class="sourceLine" id="cb44-2" data-line-number="2">data_residence[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(</a>
<a class="sourceLine" id="cb44-3" data-line-number="3">  <span class="dt">id =</span> TAG,</a>
<a class="sourceLine" id="cb44-4" data-line-number="4">  <span class="dt">x =</span> X, <span class="dt">y =</span> Y</a>
<a class="sourceLine" id="cb44-5" data-line-number="5">)]</a>
<a class="sourceLine" id="cb44-6" data-line-number="6"></a>
<a class="sourceLine" id="cb44-7" data-line-number="7"><span class="co"># get mean residence time per id</span></a>
<a class="sourceLine" id="cb44-8" data-line-number="8">data_residence[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb44-9" data-line-number="9">  <span class="dt">mean_residence =</span> <span class="kw">mean</span>(resTime),</a>
<a class="sourceLine" id="cb44-10" data-line-number="10">  <span class="dt">sd_residence =</span> <span class="kw">sd</span>(resTime)</a>
<a class="sourceLine" id="cb44-11" data-line-number="11">), by =<span class="st"> &quot;TAG&quot;</span>]</a>
<a class="sourceLine" id="cb44-12" data-line-number="12"><span class="co">#&gt;             TAG mean_residence sd_residence</span></a>
<a class="sourceLine" id="cb44-13" data-line-number="13"><span class="co">#&gt; 1: 972001004424          238.4        116.8</span></a>
<a class="sourceLine" id="cb44-14" data-line-number="14"><span class="co">#&gt; 2: 972001004449           52.8         33.5</span></a>
<a class="sourceLine" id="cb44-15" data-line-number="15"><span class="co">#&gt; 3: 972001004452           53.5         38.5</span></a>
<a class="sourceLine" id="cb44-16" data-line-number="16"></a>
<a class="sourceLine" id="cb44-17" data-line-number="17"><span class="co"># get mean residence time for all bats pooled</span></a>
<a class="sourceLine" id="cb44-18" data-line-number="18">data_residence[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb44-19" data-line-number="19">  <span class="dt">mean_residence =</span> <span class="kw">mean</span>(resTime),</a>
<a class="sourceLine" id="cb44-20" data-line-number="20">  <span class="dt">sd_residence =</span> <span class="kw">sd</span>(resTime)</a>
<a class="sourceLine" id="cb44-21" data-line-number="21">)]</a>
<a class="sourceLine" id="cb44-22" data-line-number="22"><span class="co">#&gt;    mean_residence sd_residence</span></a>
<a class="sourceLine" id="cb44-23" data-line-number="23"><span class="co">#&gt; 1:            133          123</span></a>
<a class="sourceLine" id="cb44-24" data-line-number="24"></a>
<a class="sourceLine" id="cb44-25" data-line-number="25"><span class="co"># average positions per bat after removing transit points</span></a>
<a class="sourceLine" id="cb44-26" data-line-number="26">data_residence[, <span class="kw">list</span>(.N), by =<span class="st"> &quot;TAG&quot;</span>][, <span class="kw">list</span>(<span class="dt">mean_positions_ =</span> <span class="kw">mean</span>(N))]</a>
<a class="sourceLine" id="cb44-27" data-line-number="27"><span class="co">#&gt;    mean_positions_</span></a>
<a class="sourceLine" id="cb44-28" data-line-number="28"><span class="co">#&gt; 1:            5549</span></a>
<a class="sourceLine" id="cb44-29" data-line-number="29"></a>
<a class="sourceLine" id="cb44-30" data-line-number="30"><span class="co"># split the data</span></a>
<a class="sourceLine" id="cb44-31" data-line-number="31">data_residence &lt;-<span class="st"> </span><span class="kw">split</span>(data_residence, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;TAG&quot;</span>, <span class="st">&quot;night&quot;</span>))</a></code></pre></div>
<p>We apply the residence patch method, using the default argument values (<code>lim_spat_indep = 100</code> (metres), <code>lim_time_indep = 30</code> (minutes)). We change the <code>buffer_radius</code> to 25 metres (twice the buffer radius is used, so points must be separated by 50m to be independent bouts), and <code>min_fixes = 3</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="co"># segment into residence patches</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2">data_patches &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_residence, atl_res_patch,</a>
<a class="sourceLine" id="cb45-3" data-line-number="3">  <span class="dt">buffer_radius =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb45-4" data-line-number="4">  <span class="dt">min_fixes =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb45-5" data-line-number="5">  <span class="dt">summary_variable =</span> <span class="kw">c</span>(<span class="st">&quot;night&quot;</span>, <span class="st">&quot;distance_roost&quot;</span>),</a>
<a class="sourceLine" id="cb45-6" data-line-number="6">  <span class="dt">summary_functions =</span> <span class="kw">c</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>)</a>
<a class="sourceLine" id="cb45-7" data-line-number="7">)</a></code></pre></div>
</div>
<div id="getting-residence-patch-data" class="section level3">
<h3><span class="header-section-number">2.8.5</span> Getting residence patch data</h3>
<p>We extract the residence patch data as spatial <code>sf-MULTIPOLYGON</code> objects.
These are returned as a list and must be converted into a single <code>sf</code> object.
These objects and the raw movement data are shown in Fig. 2.5.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="co"># get data spatials</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">data_spatials &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_patches, atl_patch_summary,</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">  <span class="dt">which_data =</span> <span class="st">&quot;spatial&quot;</span>,</a>
<a class="sourceLine" id="cb46-4" data-line-number="4">  <span class="dt">buffer_radius =</span> <span class="dv">25</span></a>
<a class="sourceLine" id="cb46-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb46-6" data-line-number="6"></a>
<a class="sourceLine" id="cb46-7" data-line-number="7"><span class="co"># bind list</span></a>
<a class="sourceLine" id="cb46-8" data-line-number="8">data_spatials &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(data_spatials)</a>
<a class="sourceLine" id="cb46-9" data-line-number="9"></a>
<a class="sourceLine" id="cb46-10" data-line-number="10"><span class="co"># convert to sf</span></a>
<a class="sourceLine" id="cb46-11" data-line-number="11"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb46-12" data-line-number="12">data_spatials &lt;-<span class="st"> </span><span class="kw">st_sf</span>(data_spatials, <span class="dt">sf_column_name =</span> <span class="st">&quot;polygons&quot;</span>)</a>
<a class="sourceLine" id="cb46-13" data-line-number="13"></a>
<a class="sourceLine" id="cb46-14" data-line-number="14"><span class="co"># assign a crs</span></a>
<a class="sourceLine" id="cb46-15" data-line-number="15"><span class="kw">st_crs</span>(data_spatials) &lt;-<span class="st"> </span><span class="kw">st_crs</span>(<span class="dv">2039</span>)</a></code></pre></div>
</div>
<div id="write-patch-spatial-representations" class="section level3">
<h3><span class="header-section-number">2.8.6</span> Write patch spatial representations</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">st_write</span>(data_spatials,</a>
<a class="sourceLine" id="cb47-2" data-line-number="2">  <span class="dt">dsn =</span> <span class="st">&quot;data/data_bat_residence_patches.gpkg&quot;</span>,</a>
<a class="sourceLine" id="cb47-3" data-line-number="3">  <span class="dt">append =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb47-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb47-5" data-line-number="5"><span class="co">#&gt; Deleting layer `data_bat_residence_patches&#39; using driver `GPKG&#39;</span></a>
<a class="sourceLine" id="cb47-6" data-line-number="6"><span class="co">#&gt; Writing layer `data_bat_residence_patches&#39; to data source </span></a>
<a class="sourceLine" id="cb47-7" data-line-number="7"><span class="co">#&gt;   `data/data_bat_residence_patches.gpkg&#39; using driver `GPKG&#39;</span></a>
<a class="sourceLine" id="cb47-8" data-line-number="8"><span class="co">#&gt; Writing 45 features with 22 fields and geometry type Multi Polygon.</span></a></code></pre></div>
<p>Write cleaned bat data.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">fwrite</span>(<span class="kw">rbindlist</span>(data_smooth),</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">  <span class="dt">file =</span> <span class="st">&quot;data/data_bat_smooth.csv&quot;</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3">)</a></code></pre></div>
<p>Write patch summary.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="co"># get summary</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">patch_summary &lt;-<span class="st"> </span><span class="kw">lapply</span>(data_patches, atl_patch_summary)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3"></a>
<a class="sourceLine" id="cb49-4" data-line-number="4"><span class="co"># bind summary</span></a>
<a class="sourceLine" id="cb49-5" data-line-number="5">patch_summary &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(patch_summary)</a>
<a class="sourceLine" id="cb49-6" data-line-number="6"></a>
<a class="sourceLine" id="cb49-7" data-line-number="7"><span class="co"># write</span></a>
<a class="sourceLine" id="cb49-8" data-line-number="8"><span class="kw">fwrite</span>(</a>
<a class="sourceLine" id="cb49-9" data-line-number="9">  patch_summary,</a>
<a class="sourceLine" id="cb49-10" data-line-number="10">  <span class="st">&quot;data/data_bat_patch_summary.csv&quot;</span></a>
<a class="sourceLine" id="cb49-11" data-line-number="11">)</a></code></pre></div>
</div>
<div id="duration-at-foraging-sites" class="section level3">
<h3><span class="header-section-number">2.8.7</span> Duration at foraging sites</h3>
<p>We exclude the first and last patch of each day as being roosting related, and examine how much of the total foraging time (time between the remaining first and last patch) was spent at foraging sites. It follows that the remainder of the time must have been spent in transit, or otherwise not foraging.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="co"># make patch summary a datatable</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">setDT</span>(patch_summary)</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="co"># get mean and sd of duration in patches</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5">patch_summary[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb50-6" data-line-number="6">  <span class="dt">mean_duration =</span> <span class="kw">mean</span>(duration <span class="op">/</span><span class="st"> </span><span class="dv">60</span>),</a>
<a class="sourceLine" id="cb50-7" data-line-number="7">  <span class="dt">sd_duration =</span> <span class="kw">sd</span>(duration <span class="op">/</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb50-8" data-line-number="8">)]</a>
<a class="sourceLine" id="cb50-9" data-line-number="9"><span class="co">#&gt;    mean_duration sd_duration</span></a>
<a class="sourceLine" id="cb50-10" data-line-number="10"><span class="co">#&gt; 1:            57        62.2</span></a>
<a class="sourceLine" id="cb50-11" data-line-number="11"></a>
<a class="sourceLine" id="cb50-12" data-line-number="12"><span class="co"># assign night id</span></a>
<a class="sourceLine" id="cb50-13" data-line-number="13">patch_summary[, <span class="kw">c</span>(<span class="st">&quot;hour&quot;</span>, <span class="st">&quot;day&quot;</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb50-14" data-line-number="14">  data.table<span class="op">::</span><span class="kw">hour</span>(<span class="kw">as.POSIXct</span>(time_start, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>)),</a>
<a class="sourceLine" id="cb50-15" data-line-number="15">  data.table<span class="op">::</span><span class="kw">mday</span>(<span class="kw">as.POSIXct</span>(time_start, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>))</a>
<a class="sourceLine" id="cb50-16" data-line-number="16">)]</a>
<a class="sourceLine" id="cb50-17" data-line-number="17"></a>
<a class="sourceLine" id="cb50-18" data-line-number="18"><span class="co"># get total foraging time</span></a>
<a class="sourceLine" id="cb50-19" data-line-number="19">foraging_proportion &lt;-<span class="st"> </span>patch_summary[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb50-20" data-line-number="20">  <span class="dt">time_total_forage =</span> (<span class="kw">max</span>(time_end) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(time_start)) <span class="op">/</span><span class="st"> </span><span class="dv">60</span>,</a>
<a class="sourceLine" id="cb50-21" data-line-number="21">  <span class="dt">time_forage_site =</span> <span class="kw">sum</span>(duration <span class="op">/</span><span class="st"> </span><span class="dv">60</span>)</a>
<a class="sourceLine" id="cb50-22" data-line-number="22">),</a>
<a class="sourceLine" id="cb50-23" data-line-number="23">by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;night_mean&quot;</span>)</a>
<a class="sourceLine" id="cb50-24" data-line-number="24">]</a>
<a class="sourceLine" id="cb50-25" data-line-number="25"></a>
<a class="sourceLine" id="cb50-26" data-line-number="26"><span class="co"># get proporion of foraging that is at a foraging site</span></a>
<a class="sourceLine" id="cb50-27" data-line-number="27">foraging_proportion[, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb50-28" data-line-number="28">  <span class="dt">mean_foraging_prop =</span> <span class="kw">mean</span>(time_forage_site <span class="op">/</span><span class="st"> </span>time_total_forage),</a>
<a class="sourceLine" id="cb50-29" data-line-number="29">  <span class="dt">sd_foraging_prop =</span> <span class="kw">sd</span>(time_forage_site <span class="op">/</span><span class="st"> </span>time_total_forage)</a>
<a class="sourceLine" id="cb50-30" data-line-number="30">)]</a>
<a class="sourceLine" id="cb50-31" data-line-number="31"><span class="co">#&gt;    mean_foraging_prop sd_foraging_prop</span></a>
<a class="sourceLine" id="cb50-32" data-line-number="32"><span class="co">#&gt; 1:              0.838            0.155</span></a></code></pre></div>
</div>
</div>
<div id="main-text-figure-8" class="section level2">
<h2><span class="header-section-number">2.9</span> Main text Figure 8</h2>
<p>See Fig. 8 in the main text, made with QGIS.</p>
<div class="figure">
<img src="../figures/fig_08.png" alt="A visual examination of plots of the bats’ residence patches and linear approximations of paths between them showed that though all three bats roosted at the same site, they used distinct areas of the study site over the three nights (a). Bats tended to be resident near fruit trees, which are their main food source, travelling repeatedly between previously visited areas (b, c). However, bats also appeared to spend some time at locations where no fruit trees were recorded, prompting questions about their use of other food sources (b, c). When bats did occur close together, their residence patches barely overlapped, and their paths to and from the broad area of co-occurrence were not similar (c). Constructing residence patches for multiple individuals over multiple activity periods suggests interesting dynamics of within- and between-individual overlap (b, c)." />
<p class="caption">A visual examination of plots of the bats’ residence patches and linear approximations of paths between them showed that though all three bats roosted at the same site, they used distinct areas of the study site over the three nights <strong>(a)</strong>.
Bats tended to be resident near fruit trees, which are their main food source, travelling repeatedly between previously visited areas <strong>(b, c)</strong>.
However, bats also appeared to spend some time at locations where no fruit trees were recorded, prompting questions about their use of other food sources <strong>(b, c)</strong>.
When bats did occur close together, their residence patches barely overlapped, and their paths to and from the broad area of co-occurrence were not similar <strong>(c)</strong>.
Constructing residence patches for multiple individuals over multiple activity periods suggests interesting dynamics of within- and between-individual overlap <strong>(b, c)</strong>.</p>
</div>

</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-bracis2018">
<p>Bracis, Chloe, Keith L. Bildstein, and Thomas Mueller. 2018. “Revisitation Analysis Uncovers Spatio-Temporal Patterns in Animal Movement Data.” <em>Ecography</em> 41 (11): 1801–11. <a href="https://doi.org/10.1111/ecog.03618" class="uri">https://doi.org/10.1111/ecog.03618</a>.</p>
</div>
<div id="ref-dowle2020">
<p>Dowle, Matt, and Arun Srinivasan. 2020. <em>Data.Table: Extension of ‘data.Frame‘</em>. Manual.</p>
</div>
<div id="ref-shohami2020">
<p>Shohami, David, and Ran Nathan. 2020. “Cognitive Map-Based Navigation in Wild Bats Revealed by a New High-Throughput Tracking System.” Dryad. <a href="https://doi.org/10.5061/DRYAD.G4F4QRFN2" class="uri">https://doi.org/10.5061/DRYAD.G4F4QRFN2</a>.</p>
</div>
<div id="ref-toledo2020">
<p>Toledo, Sivan, David Shohami, Ingo Schiffner, Emmanuel Lourie, Yotam Orchan, Yoav Bartan, and Ran Nathan. 2020. “Cognitive MapBased Navigation in Wild Bats Revealed by a New High-Throughput Tracking System.” <em>Science</em> 369 (6500). American Association for the Advancement of Science: 188–93. <a href="https://doi.org/10.1126/science.aax6904" class="uri">https://doi.org/10.1126/science.aax6904</a>.</p>
</div>
<div id="ref-weiser2016">
<p>Weiser, Adi Weller, Yotam Orchan, Ran Nathan, Motti Charter, Anthony J. Weiss, and Sivan Toledo. 2016. “Characterizing the Accuracy of a Self-Synchronized Reverse-GPS Wildlife Localization System.” In <em>2016 15th ACM/IEEE International Conference on Information Processing in Sensor Networks (IPSN)</em>, 1–12. <a href="https://doi.org/10.1109/IPSN.2016.7460662" class="uri">https://doi.org/10.1109/IPSN.2016.7460662</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="validating-the-residence-patch-method-with-calibration-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["supplementary_material.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
