<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Methods | ms</title>
  <meta name="description" content="TRES Tidyverse Tutorial" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Methods | ms" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="TRES Tidyverse Tutorial" />
  <meta name="github-repo" content="pratikunterwegs/atlas-best-practices" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Methods | ms" />
  
  <meta name="twitter:description" content="TRES Tidyverse Tutorial" />
  

<meta name="author" content="Pratik R. Gupte and others" />


<meta name="date" content="2020-07-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="background.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>2</b> Methods</a>
<ul>
<li class="chapter" data-level="2.1" data-path="methods.html"><a href="methods.html#filtering-point-locations"><i class="fa fa-check"></i><b>2.1</b> Filtering point locations</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="methods.html"><a href="methods.html#basic-spatio-temporal-filtering"><i class="fa fa-check"></i><b>2.1.1</b> Basic spatio-temporal filtering</a></li>
<li class="chapter" data-level="2.1.2" data-path="methods.html"><a href="methods.html#filtering-on-metadata"><i class="fa fa-check"></i><b>2.1.2</b> Filtering on metadata</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="methods.html"><a href="methods.html#filtering-trajectories"><i class="fa fa-check"></i><b>2.2</b> Filtering trajectories</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="methods.html"><a href="methods.html#speed-and-turning-angle-filters"><i class="fa fa-check"></i><b>2.2.1</b> Speed and turning angle filters</a></li>
<li class="chapter" data-level="2.2.2" data-path="methods.html"><a href="methods.html#removing-trajectory-reflections"><i class="fa fa-check"></i><b>2.2.2</b> Removing trajectory reflections</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ms</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="methods" class="section level1">
<h1><span class="header-section-number">2</span> Methods</h1>
<div id="filtering-point-locations" class="section level2">
<h2><span class="header-section-number">2.1</span> Filtering point locations</h2>
<div id="basic-spatio-temporal-filtering" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Basic spatio-temporal filtering</h3>
<p>Filtering animal tracking data on existing variables is an easy first step in preparing data for further analysis.
The majority of modern animal tracking studies consist at least of a time series coupled with spatial coordinates (hereafter referred to as X and Y for convenience), with other covariates for each observation.
These three variables are already sufficient to eliminate serious positioning errors.
In a basic first step, data can be filtered to exclude positions outside the bounding box of a known study area.
This only involves comparing position coordinates with the range of acceptable coordinates, and removing those positions which fall outside of this range.
Filtering on a bounding box is the fastest spatial filtering method and can quickly remove the most serious positioning errors without requiring knowledge of spatial computation.
However, it can only select data within a right-angled quadrangular area.</p>
<p>Explicit spatial filtering is a finer method which examines whether the tracking data lie within a polygon, which may be irregular.
This typically involves converting the data’s position coordinates to a multi-point spatial geometry, and finding the intersection with a polygon or multi-polygon geometry representing a study area.
Combined with knowledge of species’ biology and the study site, explicit spatial filtering can be used to remove obviously erroneous positions such as those that would place an individual in an area it is physiologically incapable of traversing.
Both bounding box and explicit spatial filters can be combined with the timestamp of a position to remove locations where time is an important determinant of accessibility.
For example, terrestrial species may be able to access the bottom of a waterbody only during certain times of day or year, and data whose time and position coordinates do not meet these criteria can be removed.</p>
<p>Temporal filtering can also be applied independently of spatial filtering to exclude positions from certain time periods during tracking.
These are typically periods when data are expected to be biased, such as where an animal has been fitted with a tracker but has not been released, or from the first day after fitting a tracker to avoid including movement behaviour biased by the stress of the capture.
Such broad filters must always be applied with caution; they are especially susceptible to excluding data that represent novel space use of which researchers are unaware, such as a new movement mode or changed local conditions which make it possible for species to move across previously inaccessible regions.</p>
</div>
<div id="filtering-on-metadata" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Filtering on metadata</h3>
<p>Simple spatial and temporal filters are agnostic to any correlation between the status of a tracking system and the extent of error.
However, both may be refined by consulting tracking system metadata, i.e., data on the status of the tracking system itself, which can be a good indicator of the reliability of calculated positions.
For example, at a broad scale the number of active receivers in an ATLAS system can indicate time periods when a system suffers a malfunction and thus collects unreliable data; these ‘down times’ can form the basis of a temporal filter.
Similarly, data from system tests may reveal regions of the study area in which the system’s localisations are error-prone, and can inform an explicit spatial filter.
At smaller scales the observation-specific metadata may be used to filter out locations which fail to meet a certain cutoff.
For example, ATLAS systems calculate animal positions using the times of arrival of a radio transmission from each tag to multiple receiver stations.
The number of receiver stations involved in each localisation is considered to be an indicator of data quality, and positions localised using fewer than three receivers (the minimum required for an ATLAS localisation) can be excluded.</p>
<p>Further, tracking systems often yield internal measures of positioning error which are based on the dilution of precision.
ATLAS and other time-of-arrival systems calculate positioning error in two dimensions (MacCurdy et al. 2009), while other systems may yield a three dimensional positioning error.
Positioning error is an intuitive criterion by which to filter data, and this takes the form of locations with an estimated error above a certain threshold being excluded.
There are two other ways of dealing with positioning errors, and of these the aggregation of positions over a time interval is discussed below.
The more demanding method is to model the animal’s movement, for example, in a continuous time movement model (Calabrese et al. 2016; Noonan et al. 2019).
Movement model methods can use the positioning error from the tracking system, in conjunction with calibration data, to estimate the real individual position and movement distances between positions.
However, movement model methods are computationally intensive, make several assumptions about animal movement, and can be challenging to implement for the beginning practitioner, and are not discussed further.</p>
</div>
</div>
<div id="filtering-trajectories" class="section level2">
<h2><span class="header-section-number">2.2</span> Filtering trajectories</h2>
<div id="speed-and-turning-angle-filters" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Speed and turning angle filters</h3>
<p>Since the phenomenon represented by data from animal tracking studies is movement, it is appropriate and necessary to examine whether individual trajectories obtained by joining positions remaining from previous filtering steps are realistic.
This is often a subjective assessment based on expert judgement of the observed movement tracks, which presents two main problems: first, subjective assessments are difficult to reproduce, which hampers consistent analyses across tracking periods.
The second issue is that manual identification and correction of problematic trajectories is prohibitively time consuming when dealing with high volumes of data.
The solution to both problems is to employ a hybrid approach, in which experts manually examine a subset of movement tracks (rather than positions) and attempt to identify common problems with the trajectories.
Experts can then conceptualise an algorithm by which problematic sections of a trajectory may be removed, and automate the application of this algorithm to the wider dataset, under the assumption that the subset used to define the algorithm is representative of the full data.</p>
<p>Algorithms for filtering trajectories are different from those for filtering point locations in that they commonly filter on derivative variables, i.e., the instantaneous change in some variable with respect to another variable.
The two most common derivative variables are speed, the change in position in unit time, and turning angle, the change in heading in unit time.
Speed and turning angle filters should be applied in a stepwise fashion, and it is safest to first apply a simple speed filter that removes positions with instantaneous speeds above a certain threshold.
This threshold should be informed by the tracked animal’s biology, but it is also important to consider that high frequency tracking typically overestimates the speed between positions due to positioning error (Ranacher et al. 2016; an explanation for animal tracking data is given in Noonan et al. 2019).
Even assuming data with large positioning errors have been removed, it is advisable to begin with a liberal speed threshold that excludes only the most unlikely of movements.</p>
<p>Speed filters have the drawback of removing at twice as many positions as strictly necessary (the speed duplication problem).
For example, in a trajectory of three positions (p1, p2, and p3), the outlier p2 has a high instantaneous speed, as does the ‘real’ position p3, whose displacement is calculated relative to the outlier p2; both will be removed by the same speed filter.
Speed filtering with low thresholds also risks losing valid data on fast transit behaviour of a study species, and this is especially a risk for aerial transit which can be strongly assisted by winds.
In such cases, trning angle filters can help distinguish between high instantaneous speeds arising from positioning error and those that comprise a fast transit segment.
Most animals are physiologically constrained to move quickly only in relatively straight lines, i.e., with low turning angles, and large turning angles coupled with high speeds often represent positioning errors in the data, whereas high speed - low angle positions are likely to capture extreme yet real movements.</p>
</div>
<div id="removing-trajectory-reflections" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Removing trajectory reflections</h3>
<p>A more serious challenge to speed filters is the tracking system phenomenon of ‘reflected’ positions, in which the estimated location is instantaneously displaced many hundreds of metres from the individual’s real position for some time, followed by a return to the real position.
In such a ‘reflection’ comprised of the positions t1…tr, p1…pn, and tr+1…tn where positions denoted by t represent real trajectory positions, and those denoted p represent reflected data a great distance from the real trajectory, the positions p1 and tr+1 will have very high instantaneous speeds.
A speed filter applied to such reflected data would only remove p1 and tr+1, leaving the positions p2…pn, which are erroneous and must be removed.
Iteratively applying a speed filter to this data while recalculating speeds in each iteration until no positions with extreme speeds remain is an imperfect solution, since it will remove valid positions tr+i for each erroneous position pi; the true scale of the speed duplication problem is thus revealed.</p>
<p>A more heuristic approach to dealing with trajectory reflections involves using the phenomenon’s properties to identify its bounds and removing all positions between these bounds.
The first step is identifying positions with anomalous (usually extremely high) speeds and turning angles, as in the point outlier case.
The trajectory can then be split into pre- and post-anomaly segments, and the first position of the post-anomaly segment, which is the inner bound of the reflection, can be set as an anchor point.
The first position after the anchor point with an instantaneous speed &gt;= the anchor point can be considered to be the upper bound of the reflection, and lacking such a position, the position with the next greatest instantaneous speed can be considered the outer bound of the reflection.
The positions between these bounds can be identified as a trajectory reflection and removed.
This method is robust to variable displacement of the reflections from the real positions, and also to displacement in the real position of the individual itself.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="background.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
